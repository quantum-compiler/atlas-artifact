Num ranks: 2, myrank: 0
Num ranks: 2, myrank: 1
Solving ILP for num_qubits=31, num_local_qubits=28, num_global_qubits=1, num_iterations=1...
Available solvers: ['PULP_CBC_CMD', 'HiGHS_CMD']
Solving ILP for num_qubits=31, num_local_qubits=28, num_global_qubits=1, num_iterations=1...
Available solvers: ['PULP_CBC_CMD', 'HiGHS_CMD']
Running HiGHS 1.5.0 [date: 2023-11-09, git hash: 8a114449a]
Copyright (c) 2022 HiGHS under MIT licence terms
Number of BV entries in BOUNDS section is 186
MIP  c95b4c983010404ab4113e42382edb76-pulp has 374 rows; 187 cols; 713 nonzeros; 186 integer variables
Presolving model
250 rows, 62 cols, 155 nonzeros
Presolve: Infeasible

Solving report
  Status            Infeasible
  Primal bound      inf
  Dual bound        -inf
  Gap               inf
  Solution status   -
  Timing            0.00 (total)
                    0.00 (presolve)
                    0.00 (postsolve)
  Nodes             0
  LP iterations     0 (total)
                    0 (strong br.)
                    0 (separation)
                    0 (heuristics)
Writing the solution to /tmp/c95b4c983010404ab4113e42382edb76-pulp.sol
Solving ILP for num_qubits=31, num_local_qubits=28, num_global_qubits=1, num_iterations=2...
Running HiGHS 1.5.0 [date: 2023-11-09, git hash: 8a114449a]
Copyright (c) 2022 HiGHS under MIT licence terms
Number of BV entries in BOUNDS section is 186
MIP  69f2f2704ae84073920a366fed7929b5-pulp has 374 rows; 187 cols; 713 nonzeros; 186 integer variables
Available solvers: ['PULP_CBC_CMD', 'HiGHS_CMD']
Presolving model
250 rows, 62 cols, 155 nonzeros
Presolve: Infeasible

Solving report
  Status            Infeasible
  Primal bound      inf
  Dual bound        -inf
  Gap               inf
  Solution status   -
  Timing            0.00 (total)
                    0.00 (presolve)
                    0.00 (postsolve)
  Nodes             0
  LP iterations     0 (total)
                    0 (strong br.)
                    0 (separation)
                    0 (heuristics)
Writing the solution to /tmp/69f2f2704ae84073920a366fed7929b5-pulp.sol
Solving ILP for num_qubits=31, num_local_qubits=28, num_global_qubits=1, num_iterations=2...
Available solvers: ['PULP_CBC_CMD', 'HiGHS_CMD']
Running HiGHS 1.5.0 [date: 2023-11-09, git hash: 8a114449a]
Copyright (c) 2022 HiGHS under MIT licence terms
Number of BV entries in BOUNDS section is 372
MIP  b8a22c60466d4bba8638a77001f961b4-pulp has 624 rows; 372 cols; 1364 nonzeros; 372 integer variables
Presolving model
500 rows, 248 cols, 806 nonzeros
159 rows, 186 cols, 496 nonzeros
159 rows, 186 cols, 496 nonzeros
Objective function is integral with scale 1

Solving MIP model with:
   159 rows
   186 cols (186 binary, 0 integer, 0 implied int., 0 continuous)
   496 nonzeros

        Nodes      |    B&B Tree     |            Objective Bounds              |  Dynamic Constraints |       Work      
     Proc. InQueue |  Leaves   Expl. | BestBound       BestSol              Gap |   Cuts   InLp Confl. | LpIters     Time

         0       0         0   0.00%   0               inf                  inf        0      0      0         0     0.0s
 R       0       0         0   0.00%   0               6                100.00%        0      0      0        63     0.0s

Solving report
  Status            Optimal
  Primal bound      6
  Dual bound        6
  Gap               0% (tolerance: 0.01%)
  Solution status   feasible
                    6 (objective)
                    0 (bound viol.)
                    0 (int. viol.)
                    0 (row viol.)
  Timing            0.01 (total)
                    0.00 (presolve)
                    0.00 (postsolve)
  Nodes             1
  LP iterations     211 (total)
                    0 (strong br.)
                    148 (separation)
                    0 (heuristics)
Writing the solution to /tmp/b8a22c60466d4bba8638a77001f961b4-pulp.sol
Running HiGHS 1.5.0 [date: 2023-11-09, git hash: 8a114449a]
Copyright (c) 2022 HiGHS under MIT licence terms
Number of BV entries in BOUNDS section is 372
MIP  a4d4809ca282405497a665e5d6de914f-pulp has 624 rows; 372 cols; 1364 nonzeros; 372 integer variables
Presolving model
500 rows, 248 cols, 806 nonzeros
159 rows, 186 cols, 496 nonzeros
159 rows, 186 cols, 496 nonzeros
Objective function is integral with scale 1

Solving MIP model with:
   159 rows
   186 cols (186 binary, 0 integer, 0 implied int., 0 continuous)
   496 nonzeros

        Nodes      |    B&B Tree     |            Objective Bounds              |  Dynamic Constraints |       Work      
     Proc. InQueue |  Leaves   Expl. | BestBound       BestSol              Gap |   Cuts   InLp Confl. | LpIters     Time

         0       0         0   0.00%   0               inf                  inf        0      0      0         0     0.0s
 R       0       0         0   0.00%   0               6                100.00%        0      0      0        63     0.0s

Solving report
  Status            Optimal
  Primal bound      6
  Dual bound        6
  Gap               0% (tolerance: 0.01%)
  Solution status   feasible
                    6 (objective)
                    0 (bound viol.)
                    0 (int. viol.)
                    0 (row viol.)
  Timing            0.01 (total)
                    0.00 (presolve)
                    0.00 (postsolve)
  Nodes             1
  LP iterations     211 (total)
                    0 (strong br.)
                    148 (separation)
                    0 (heuristics)
Writing the solution to /tmp/a4d4809ca282405497a665e5d6de914f-pulp.sol
Computed and cached schedule in 4.686 seconds.
Current Layout0: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 16, 26, 15, Start fusing gates...
Reset qubit group map
(4, 4) (5, 5) (10, 10) (11, 11) (19, 21) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,17,18,19,20,21,22,23,24,25,27,28,29,30,16,26,15,]
Fusing Kernel (8 gates): qubits [4, 5, 10, 11, 21], gates fusion, qubits [4, 5, 10, 11, 21], gates CircuitSeq {
  Q4 = h(Q4)
  Q5 = h(Q5)
  [Q4, Q5] = cz(Q4, Q5)
  Q10 = h(Q10)
  Q11 = h(Q11)
  [Q10, Q11] = cz(Q10, Q11)
  Q21 = h(Q21)
  [Q5, Q21] = cz(Q5, Q21)
}

Gate 0: [4, ]
Fusing gate 0(0) for rank 4
t 4
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 5
t 4
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 6
t 4
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 7
t 4
Matrix Multiplication (5, 1), mask 1
Gate 1: [5, ]
Fusing gate 0(0) for rank 4
t 5
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 5
t 5
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 6
t 5
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 7
t 5
Matrix Multiplication (5, 1), mask 2
Gate 2: [4, 5, ]
Fusing gate 25(1) for rank 4
c,t 4,5
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 5
c,t 4,5
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 6
c,t 4,5
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 7
c,t 4,5
Matrix Multiplication (5, 2), mask 3
Gate 3: [10, ]
Fusing gate 0(0) for rank 4
t 10
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 5
t 10
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 6
t 10
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 7
t 10
Matrix Multiplication (5, 1), mask 4
Gate 4: [11, ]
Fusing gate 0(0) for rank 4
t 11
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 5
t 11
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 6
t 11
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 7
t 11
Matrix Multiplication (5, 1), mask 8
Gate 5: [10, 11, ]
Fusing gate 25(1) for rank 4
c,t 10,11
Matrix Multiplication (5, 2), mask 12
Fusing gate 25(1) for rank 5
c,t 10,11
Matrix Multiplication (5, 2), mask 12
Fusing gate 25(1) for rank 6
c,t 10,11
Matrix Multiplication (5, 2), mask 12
Fusing gate 25(1) for rank 7
c,t 10,11
Matrix Multiplication (5, 2), mask 12
Gate 6: [21, ]
Fusing gate 0(0) for rank 4
t 21
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 5
t 21
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 6
t 21
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 7
t 21
Matrix Multiplication (5, 1), mask 16
Gate 7: [5, 21, ]
Fusing gate 25(1) for rank 4
c,t 5,21
Matrix Multiplication (5, 2), mask 18
Fusing gate 25(1) for rank 5
c,t 5,21
Matrix Multiplication (5, 2), mask 18
Fusing gate 25(1) for rank 6
c,t 5,21
Matrix Multiplication (5, 2), mask 18
Fusing gate 25(1) for rank 7
c,t 5,21
Matrix Multiplication (5, 2), mask 18
Start fusing gates...
Reset qubit group map
(8, 8) (9, 9) (12, 12) (13, 13) (18, 20) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,17,18,19,20,21,22,23,24,25,27,28,29,30,16,26,15,]
Fusing Kernel (8 gates): qubits [8, 9, 12, 13, 20], gates fusion, qubits [8, 9, 12, 13, 20], gates CircuitSeq {
  Q8 = h(Q8)
  Q9 = h(Q9)
  [Q8, Q9] = cz(Q8, Q9)
  Q12 = h(Q12)
  Q13 = h(Q13)
  [Q12, Q13] = cz(Q12, Q13)
  Q20 = h(Q20)
  [Q13, Q20] = cz(Q13, Q20)
}

Gate 0: [8, ]
Fusing gate 0(0) for rank 4
t 8
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 5
t 8
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 6
t 8
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 7
t 8
Matrix Multiplication (5, 1), mask 1
Gate 1: [9, ]
Fusing gate 0(0) for rank 4
t 9
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 5
t 9
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 6
t 9
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 7
t 9
Matrix Multiplication (5, 1), mask 2
Gate 2: [8, 9, ]
Fusing gate 25(1) for rank 4
c,t 8,9
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 5
c,t 8,9
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 6
c,t 8,9
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 7
c,t 8,9
Matrix Multiplication (5, 2), mask 3
Gate 3: [12, ]
Fusing gate 0(0) for rank 4
t 12
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 5
t 12
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 6
t 12
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 7
t 12
Matrix Multiplication (5, 1), mask 4
Gate 4: [13, ]
Fusing gate 0(0) for rank 4
t 13
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 5
t 13
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 6
t 13
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 7
t 13
Matrix Multiplication (5, 1), mask 8
Gate 5: [12, 13, ]
Fusing gate 25(1) for rank 4
c,t 12,13
Matrix Multiplication (5, 2), mask 12
Fusing gate 25(1) for rank 5
c,t 12,13
Matrix Multiplication (5, 2), mask 12
Fusing gate 25(1) for rank 6
c,t 12,13
Matrix Multiplication (5, 2), mask 12
Fusing gate 25(1) for rank 7
c,t 12,13
Matrix Multiplication (5, 2), mask 12
Gate 6: [20, ]
Fusing gate 0(0) for rank 4
t 20
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 5
t 20
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 6
t 20
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 7
t 20
Matrix Multiplication (5, 1), mask 16
Gate 7: [13, 20, ]
Fusing gate 25(1) for rank 4
c,t 13,20
Matrix Multiplication (5, 2), mask 24
Fusing gate 25(1) for rank 5
c,t 13,20
Matrix Multiplication (5, 2), mask 24
Fusing gate 25(1) for rank 6
c,t 13,20
Matrix Multiplication (5, 2), mask 24
Fusing gate 25(1) for rank 7
c,t 13,20
Matrix Multiplication (5, 2), mask 24
Start fusing gates...
Reset qubit group map
(6, 6) (7, 7) (16, 18) (17, 19) (22, 24) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,17,18,19,20,21,22,23,24,25,27,28,29,30,16,26,15,]
Fusing Kernel (8 gates): qubits [6, 7, 18, 19, 24], gates fusion, qubits [6, 7, 18, 19, 24], gates CircuitSeq {
  Q6 = h(Q6)
  Q7 = h(Q7)
  [Q6, Q7] = cz(Q6, Q7)
  Q18 = h(Q18)
  Q19 = h(Q19)
  [Q18, Q19] = cz(Q18, Q19)
  Q24 = h(Q24)
  [Q6, Q24] = cz(Q6, Q24)
}

Gate 0: [6, ]
Fusing gate 0(0) for rank 4
t 6
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 5
t 6
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 6
t 6
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 7
t 6
Matrix Multiplication (5, 1), mask 1
Gate 1: [7, ]
Fusing gate 0(0) for rank 4
t 7
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 5
t 7
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 6
t 7
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 7
t 7
Matrix Multiplication (5, 1), mask 2
Gate 2: [6, 7, ]
Fusing gate 25(1) for rank 4
c,t 6,7
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 5
c,t 6,7
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 6
c,t 6,7
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 7
c,t 6,7
Matrix Multiplication (5, 2), mask 3
Gate 3: [18, ]
Fusing gate 0(0) for rank 4
t 18
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 5
t 18
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 6
t 18
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 7
t 18
Matrix Multiplication (5, 1), mask 4
Gate 4: [19, ]
Fusing gate 0(0) for rank 4
t 19
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 5
t 19
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 6
t 19
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 7
t 19
Matrix Multiplication (5, 1), mask 8
Gate 5: [18, 19, ]
Fusing gate 25(1) for rank 4
c,t 18,19
Matrix Multiplication (5, 2), mask 12
Fusing gate 25(1) for rank 5
c,t 18,19
Matrix Multiplication (5, 2), mask 12
Fusing gate 25(1) for rank 6
c,t 18,19
Matrix Multiplication (5, 2), mask 12
Fusing gate 25(1) for rank 7
c,t 18,19
Matrix Multiplication (5, 2), mask 12
Gate 6: [24, ]
Fusing gate 0(0) for rank 4
t 24
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 5
t 24
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 6
t 24
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 7
t 24
Matrix Multiplication (5, 1), mask 16
Gate 7: [6, 24, ]
Fusing gate 25(1) for rank 4
c,t 6,24
Matrix Multiplication (5, 2), mask 17
Fusing gate 25(1) for rank 5
c,t 6,24
Matrix Multiplication (5, 2), mask 17
Fusing gate 25(1) for rank 6
c,t 6,24
Matrix Multiplication (5, 2), mask 17
Fusing gate 25(1) for rank 7
c,t 6,24
Matrix Multiplication (5, 2), mask 17
SHM Kernel Physical (24): [ 0,1,2,3,20,21,23,25,26,27]
shared_memory, qubits [0, 1, 2, 3, 22, 23, 25, 28, 29, 30], gates CircuitSeq {
  Q0 = h(Q0)
  Q1 = h(Q1)
  [Q0, Q1] = cz(Q0, Q1)
  Q3 = h(Q3)
  [Q1, Q3] = cz(Q1, Q3)
  Q2 = h(Q2)
  [Q2, Q3] = cz(Q2, Q3)
  [Q20, Q21] = cz(Q20, Q21)
  Q22 = h(Q22)
  [Q0, Q22] = cz(Q0, Q22)
  Q23 = h(Q23)
  [Q12, Q23] = cz(Q12, Q23)
  Q25 = h(Q25)
  [Q10, Q25] = cz(Q10, Q25)
  [Q24, Q25] = cz(Q24, Q25)
  Q28 = h(Q28)
  [Q2, Q28] = cz(Q2, Q28)
  [Q18, Q28] = cz(Q18, Q28)
  Q29 = h(Q29)
  [Q4, Q29] = cz(Q4, Q29)
  [Q19, Q29] = cz(Q19, Q29)
  Q30 = h(Q30)
  [Q9, Q30] = cz(Q9, Q30)
  [Q11, Q30] = cz(Q11, Q30)
}

Current Layout0: [0, 1, 2, 3, 4, 5, 6, 7, 8, 30, 10, 11, 12, 28, 14, 17, 18, 19, 20, 21, 22, 23, 24, 29, 27, 16, 26, 15, 13, 25, 9, SHM Kernel Physical (14): [ 14,27,25,15,26,24]
shared_memory, qubits [14, 15, 16, 17, 26, 27], gates CircuitSeq {
  Q14 = h(Q14)
  Q15 = h(Q15)
  [Q14, Q15] = cz(Q14, Q15)
  Q16 = h(Q16)
  [Q8, Q16] = cz(Q8, Q16)
  Q17 = h(Q17)
  [Q16, Q17] = cz(Q16, Q17)
  [Q15, Q22] = cz(Q15, Q22)
  [Q17, Q23] = cz(Q17, Q23)
  Q26 = h(Q26)
  [Q7, Q26] = cz(Q7, Q26)
  Q27 = h(Q27)
  [Q14, Q27] = cz(Q14, Q27)
  [Q26, Q27] = cz(Q26, Q27)
}

Compilation Done! 
Num Shuffles: 1
Num FUSION Kernel: 3
Num SHM Kernel: 2
Start Simulating...
Computed and cached schedule in 4.735 seconds.
Current Layout0: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 16, 26, 15, Start fusing gates...
Reset qubit group map
(4, 4) (5, 5) (10, 10) (11, 11) (19, 21) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,17,18,19,20,21,22,23,24,25,27,28,29,30,16,26,15,]
Fusing Kernel (8 gates): qubits [4, 5, 10, 11, 21], gates fusion, qubits [4, 5, 10, 11, 21], gates CircuitSeq {
  Q4 = h(Q4)
  Q5 = h(Q5)
  [Q4, Q5] = cz(Q4, Q5)
  Q10 = h(Q10)
  Q11 = h(Q11)
  [Q10, Q11] = cz(Q10, Q11)
  Q21 = h(Q21)
  [Q5, Q21] = cz(Q5, Q21)
}

Gate 0: [4, ]
Fusing gate 0(0) for rank 0
t 4
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 1
t 4
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 2
t 4
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 3
t 4
Matrix Multiplication (5, 1), mask 1
Gate 1: [5, ]
Fusing gate 0(0) for rank 0
t 5
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 1
t 5
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 2
t 5
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 3
t 5
Matrix Multiplication (5, 1), mask 2
Gate 2: [4, 5, ]
Fusing gate 25(1) for rank 0
c,t 4,5
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 1
c,t 4,5
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 2
c,t 4,5
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 3
c,t 4,5
Matrix Multiplication (5, 2), mask 3
Gate 3: [10, ]
Fusing gate 0(0) for rank 0
t 10
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 1
t 10
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 2
t 10
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 3
t 10
Matrix Multiplication (5, 1), mask 4
Gate 4: [11, ]
Fusing gate 0(0) for rank 0
t 11
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 1
t 11
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 2
t 11
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 3
t 11
Matrix Multiplication (5, 1), mask 8
Gate 5: [10, 11, ]
Fusing gate 25(1) for rank 0
c,t 10,11
Matrix Multiplication (5, 2), mask 12
Fusing gate 25(1) for rank 1
c,t 10,11
Matrix Multiplication (5, 2), mask 12
Fusing gate 25(1) for rank 2
c,t 10,11
Matrix Multiplication (5, 2), mask 12
Fusing gate 25(1) for rank 3
c,t 10,11
Matrix Multiplication (5, 2), mask 12
Gate 6: [21, ]
Fusing gate 0(0) for rank 0
t 21
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 1
t 21
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 2
t 21
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 3
t 21
Matrix Multiplication (5, 1), mask 16
Gate 7: [5, 21, ]
Fusing gate 25(1) for rank 0
c,t 5,21
Matrix Multiplication (5, 2), mask 18
Fusing gate 25(1) for rank 1
c,t 5,21
Matrix Multiplication (5, 2), mask 18
Fusing gate 25(1) for rank 2
c,t 5,21
Matrix Multiplication (5, 2), mask 18
Fusing gate 25(1) for rank 3
c,t 5,21
Matrix Multiplication (5, 2), mask 18
Start fusing gates...
Reset qubit group map
(8, 8) (9, 9) (12, 12) (13, 13) (18, 20) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,17,18,19,20,21,22,23,24,25,27,28,29,30,16,26,15,]
Fusing Kernel (8 gates): qubits [8, 9, 12, 13, 20], gates fusion, qubits [8, 9, 12, 13, 20], gates CircuitSeq {
  Q8 = h(Q8)
  Q9 = h(Q9)
  [Q8, Q9] = cz(Q8, Q9)
  Q12 = h(Q12)
  Q13 = h(Q13)
  [Q12, Q13] = cz(Q12, Q13)
  Q20 = h(Q20)
  [Q13, Q20] = cz(Q13, Q20)
}

Gate 0: [8, ]
Fusing gate 0(0) for rank 0
t 8
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 1
t 8
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 2
t 8
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 3
t 8
Matrix Multiplication (5, 1), mask 1
Gate 1: [9, ]
Fusing gate 0(0) for rank 0
t 9
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 1
t 9
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 2
t 9
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 3
t 9
Matrix Multiplication (5, 1), mask 2
Gate 2: [8, 9, ]
Fusing gate 25(1) for rank 0
c,t 8,9
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 1
c,t 8,9
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 2
c,t 8,9
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 3
c,t 8,9
Matrix Multiplication (5, 2), mask 3
Gate 3: [12, ]
Fusing gate 0(0) for rank 0
t 12
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 1
t 12
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 2
t 12
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 3
t 12
Matrix Multiplication (5, 1), mask 4
Gate 4: [13, ]
Fusing gate 0(0) for rank 0
t 13
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 1
t 13
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 2
t 13
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 3
t 13
Matrix Multiplication (5, 1), mask 8
Gate 5: [12, 13, ]
Fusing gate 25(1) for rank 0
c,t 12,13
Matrix Multiplication (5, 2), mask 12
Fusing gate 25(1) for rank 1
c,t 12,13
Matrix Multiplication (5, 2), mask 12
Fusing gate 25(1) for rank 2
c,t 12,13
Matrix Multiplication (5, 2), mask 12
Fusing gate 25(1) for rank 3
c,t 12,13
Matrix Multiplication (5, 2), mask 12
Gate 6: [20, ]
Fusing gate 0(0) for rank 0
t 20
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 1
t 20
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 2
t 20
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 3
t 20
Matrix Multiplication (5, 1), mask 16
Gate 7: [13, 20, ]
Fusing gate 25(1) for rank 0
c,t 13,20
Matrix Multiplication (5, 2), mask 24
Fusing gate 25(1) for rank 1
c,t 13,20
Matrix Multiplication (5, 2), mask 24
Fusing gate 25(1) for rank 2
c,t 13,20
Matrix Multiplication (5, 2), mask 24
Fusing gate 25(1) for rank 3
c,t 13,20
Matrix Multiplication (5, 2), mask 24
Start fusing gates...
Reset qubit group map
(6, 6) (7, 7) (16, 18) (17, 19) (22, 24) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,17,18,19,20,21,22,23,24,25,27,28,29,30,16,26,15,]
Fusing Kernel (8 gates): qubits [6, 7, 18, 19, 24], gates fusion, qubits [6, 7, 18, 19, 24], gates CircuitSeq {
  Q6 = h(Q6)
  Q7 = h(Q7)
  [Q6, Q7] = cz(Q6, Q7)
  Q18 = h(Q18)
  Q19 = h(Q19)
  [Q18, Q19] = cz(Q18, Q19)
  Q24 = h(Q24)
  [Q6, Q24] = cz(Q6, Q24)
}

Gate 0: [6, ]
Fusing gate 0(0) for rank 0
t 6
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 1
t 6
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 2
t 6
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 3
t 6
Matrix Multiplication (5, 1), mask 1
Gate 1: [7, ]
Fusing gate 0(0) for rank 0
t 7
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 1
t 7
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 2
t 7
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 3
t 7
Matrix Multiplication (5, 1), mask 2
Gate 2: [6, 7, ]
Fusing gate 25(1) for rank 0
c,t 6,7
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 1
c,t 6,7
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 2
c,t 6,7
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 3
c,t 6,7
Matrix Multiplication (5, 2), mask 3
Gate 3: [18, ]
Fusing gate 0(0) for rank 0
t 18
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 1
t 18
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 2
t 18
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 3
t 18
Matrix Multiplication (5, 1), mask 4
Gate 4: [19, ]
Fusing gate 0(0) for rank 0
t 19
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 1
t 19
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 2
t 19
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 3
t 19
Matrix Multiplication (5, 1), mask 8
Gate 5: [18, 19, ]
Fusing gate 25(1) for rank 0
c,t 18,19
Matrix Multiplication (5, 2), mask 12
Fusing gate 25(1) for rank 1
c,t 18,19
Matrix Multiplication (5, 2), mask 12
Fusing gate 25(1) for rank 2
c,t 18,19
Matrix Multiplication (5, 2), mask 12
Fusing gate 25(1) for rank 3
c,t 18,19
Matrix Multiplication (5, 2), mask 12
Gate 6: [24, ]
Fusing gate 0(0) for rank 0
t 24
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 1
t 24
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 2
t 24
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 3
t 24
Matrix Multiplication (5, 1), mask 16
Gate 7: [6, 24, ]
Fusing gate 25(1) for rank 0
c,t 6,24
Matrix Multiplication (5, 2), mask 17
Fusing gate 25(1) for rank 1
c,t 6,24
Matrix Multiplication (5, 2), mask 17
Fusing gate 25(1) for rank 2
c,t 6,24
Matrix Multiplication (5, 2), mask 17
Fusing gate 25(1) for rank 3
c,t 6,24
Matrix Multiplication (5, 2), mask 17
SHM Kernel Physical (24): [ 0,1,2,3,20,21,23,25,26,27]
shared_memory, qubits [0, 1, 2, 3, 22, 23, 25, 28, 29, 30], gates CircuitSeq {
  Q0 = h(Q0)
  Q1 = h(Q1)
  [Q0, Q1] = cz(Q0, Q1)
  Q3 = h(Q3)
  [Q1, Q3] = cz(Q1, Q3)
  Q2 = h(Q2)
  [Q2, Q3] = cz(Q2, Q3)
  [Q20, Q21] = cz(Q20, Q21)
  Q22 = h(Q22)
  [Q0, Q22] = cz(Q0, Q22)
  Q23 = h(Q23)
  [Q12, Q23] = cz(Q12, Q23)
  Q25 = h(Q25)
  [Q10, Q25] = cz(Q10, Q25)
  [Q24, Q25] = cz(Q24, Q25)
  Q28 = h(Q28)
  [Q2, Q28] = cz(Q2, Q28)
  [Q18, Q28] = cz(Q18, Q28)
  Q29 = h(Q29)
  [Q4, Q29] = cz(Q4, Q29)
  [Q19, Q29] = cz(Q19, Q29)
  Q30 = h(Q30)
  [Q9, Q30] = cz(Q9, Q30)
  [Q11, Q30] = cz(Q11, Q30)
}

Current Layout0: [0, 1, 2, 3, 4, 5, 6, 7, 8, 30, 10, 11, 12, 28, 14, 17, 18, 19, 20, 21, 22, 23, 24, 29, 27, 16, 26, 15, 13, 25, 9, SHM Kernel Physical (14): [ 14,27,25,15,26,24]
shared_memory, qubits [14, 15, 16, 17, 26, 27], gates CircuitSeq {
  Q14 = h(Q14)
  Q15 = h(Q15)
  [Q14, Q15] = cz(Q14, Q15)
  Q16 = h(Q16)
  [Q8, Q16] = cz(Q8, Q16)
  Q17 = h(Q17)
  [Q16, Q17] = cz(Q16, Q17)
  [Q15, Q22] = cz(Q15, Q22)
  [Q17, Q23] = cz(Q17, Q23)
  Q26 = h(Q26)
  [Q7, Q26] = cz(Q7, Q26)
  Q27 = h(Q27)
  [Q14, Q27] = cz(Q14, Q27)
  [Q26, Q27] = cz(Q26, Q27)
}

Compilation Done! 
Num Shuffles: 1
Num FUSION Kernel: 3
Num SHM Kernel: 2
Start Simulating...
[warmup] size total:536870912
[warmup] size total:536870912
NCCL comm nRanks: 8, i am 0
I am 0, mask 7, I am sending to 0
I am 0, mask 7, I am sending to 1
I am 0, mask 7, I am sending to 2
I am 0, mask 7, I am sending to 3
I am 0, mask 7, I am sending to 4
I am 0, mask 7, I am sending to 5
I am 0, mask 7, I am sending to 6
I am 0, mask 7, I am sending to 7
NCCL comm nRanks: 8, i am 1
I am 1, mask 7, I am sending to 0
I am 1, mask 7, I am sending to 1
I am 1, mask 7, I am sending to 2
I am 1, mask 7, I am sending to 3
I am 1, mask 7, I am sending to 4
I am 1, mask 7, I am sending to 5
I am 1, mask 7, I am sending to 6
I am 1, mask 7, I am sending to 7
NCCL comm nRanks: 8, i am 2
I am 2, mask 7, I am sending to 0
I am 2, mask 7, I am sending to 1
I am 2, mask 7, I am sending to 2
I am 2, mask 7, I am sending to 3
I am 2, mask 7, I am sending to 4
I am 2, mask 7, I am sending to 5
I am 2, mask 7, I am sending to 6
I am 2, mask 7, I am sending to 7
NCCL comm nRanks: 8, i am 3
I am 3, mask 7, I am sending to 0
I am 3, mask 7, I am sending to 1
I am 3, mask 7, I am sending to 2
I am 3, mask 7, I am sending to 3
I am 3, mask 7, I am sending to 4
I am 3, mask 7, I am sending to 5
I am 3, mask 7, I am sending to 6
I am 3, mask 7, I am sending to 7
NCCL comm nRanks: 8, i am 4
I am 4, mask 7, I am sending to 0
I am 4, mask 7, I am sending to 1
I am 4, mask 7, I am sending to 2
I am 4, mask 7, I am sending to 3
I am 4, mask 7, I am sending to 4
I am 4, mask 7, I am sending to 5
I am 4, mask 7, I am sending to 6
I am 4, mask 7, I am sending to 7
NCCL comm nRanks: 8, i am 5
I am 5, mask 7, I am sending to 0
I am 5, mask 7, I am sending to 1
I am 5, mask 7, I am sending to 2
I am 5, mask 7, I am sending to 3
I am 5, mask 7, I am sending to 4
I am 5, mask 7, I am sending to 5
I am 5, mask 7, I am sending to 6
I am 5, mask 7, I am sending to 7
NCCL comm nRanks: 8, i am 6
I am 6, mask 7, I am sending to 0
I am 6, mask 7, I am sending to 1
I am 6, mask 7, I am sending to 2
I am 6, mask 7, I am sending to 3
I am 6, mask 7, I am sending to 4
I am 6, mask 7, I am sending to 5
I am 6, mask 7, I am sending to 6
I am 6, mask 7, I am sending to 7
NCCL comm nRanks: 8, i am 7
I am 7, mask 7, I am sending to 0
I am 7, mask 7, I am sending to 1
I am 7, mask 7, I am sending to 2
I am 7, mask 7, I am sending to 3
I am 7, mask 7, I am sending to 4
I am 7, mask 7, I am sending to 5
I am 7, mask 7, I am sending to 6
I am 7, mask 7, I am sending to 7
hello checking all2all
hello checking all2all
Init State Vectors!
Init State Vectors!
Using NCCL for cross-node shuffle
Using NCCL for cross-node shuffle
My physical id:4, 7
NCCL comm nRanks: 8, i am 4
I am 4, mask 7, I am sending to 0
I am 4, mask 7, I am sending to 1
I am 4, mask 7, I am sending to 2
I am 4, mask 7, I am sending to 3
I am 4, mask 7, I am sending to 4
I am 4, mask 7, I am sending to 5
I am 4, mask 7, I am sending to 6
I am 4, mask 7, I am sending to 7
My physical id:5, 7
NCCL comm nRanks: 8, i am 5
I am 5, mask 7, I am sending to 0
I am 5, mask 7, I am sending to 1
I am 5, mask 7, I am sending to 2
I am 5, mask 7, I am sending to 3
I am 5, mask 7, I am sending to 4
I am 5, mask 7, I am sending to 5
I am 5, mask 7, I am sending to 6
I am 5, mask 7, I am sending to 7
My physical id:6, 7
NCCL comm nRanks: 8, i am 6
I am 6, mask 7, I am sending to 0
I am 6, mask 7, I am sending to 1
I am 6, mask 7, I am sending to 2
I am 6, mask 7, I am sending to 3
I am 6, mask 7, I am sending to 4
I am 6, mask 7, I am sending to 5
I am 6, mask 7, I am sending to 6
I am 6, mask 7, I am sending to 7
My physical id:7, 7
NCCL comm nRanks: 8, i am 7
I am 7, mask 7, I am sending to 0
I am 7, mask 7, I am sending to 1
I am 7, mask 7, I am sending to 2
I am 7, mask 7, I am sending to 3
I am 7, mask 7, I am sending to 4
I am 7, mask 7, I am sending to 5
I am 7, mask 7, I am sending to 6
I am 7, mask 7, I am sending to 7
My physical id:0, 7
NCCL comm nRanks: 8, i am 0
I am 0, mask 7, I am sending to 0
I am 0, mask 7, I am sending to 1
I am 0, mask 7, I am sending to 2
I am 0, mask 7, I am sending to 3
I am 0, mask 7, I am sending to 4
I am 0, mask 7, I am sending to 5
I am 0, mask 7, I am sending to 6
I am 0, mask 7, I am sending to 7
My physical id:1, 7
NCCL comm nRanks: 8, i am 1
I am 1, mask 7, I am sending to 0
I am 1, mask 7, I am sending to 1
I am 1, mask 7, I am sending to 2
I am 1, mask 7, I am sending to 3
I am 1, mask 7, I am sending to 4
I am 1, mask 7, I am sending to 5
I am 1, mask 7, I am sending to 6
I am 1, mask 7, I am sending to 7
My physical id:2, 7
NCCL comm nRanks: 8, i am 2
I am 2, mask 7, I am sending to 0
I am 2, mask 7, I am sending to 1
I am 2, mask 7, I am sending to 2
I am 2, mask 7, I am sending to 3
I am 2, mask 7, I am sending to 4
I am 2, mask 7, I am sending to 5
I am 2, mask 7, I am sending to 6
I am 2, mask 7, I am sending to 7
My physical id:3, 7
NCCL comm nRanks: 8, i am 3
I am 3, mask 7, I am sending to 0
I am 3, mask 7, I am sending to 1
I am 3, mask 7, I am sending to 2
I am 3, mask 7, I am sending to 3
I am 3, mask 7, I am sending to 4
I am 3, mask 7, I am sending to 5
I am 3, mask 7, I am sending to 6
I am 3, mask 7, I am sending to 7
[NCCL Rank 0] Shuffle Time: 121.83ms
[NCCL Rank 1] Shuffle Time: 123.17ms
[NCCL Rank 2] Shuffle Time: 123.16ms
[NCCL Rank 3] Shuffle Time: 125.46ms
[NCCL Rank 4] Shuffle Time: 125.73ms
[NCCL Rank 5] Shuffle Time: 125.74ms
[NCCL Rank 6] Shuffle Time: 125.71ms
[NCCL Rank 7] Shuffle Time: 125.74ms
Finish Simulating! Total: 3 FUSE Kernel, 2 SHM Kernel, 1 Shuffles.
Finish Simulating! Total: 3 FUSE Kernel, 2 SHM Kernel, 1 Shuffles.
[NCCL Rank 4] Total Simulation Time: 189.67ms
[NCCL Rank 5] Total Simulation Time: 189.69ms
[NCCL Rank 6] Total Simulation Time: 189.69ms
[NCCL Rank 7] Total Simulation Time: 189.71ms
[NCCL Rank 0] Total Simulation Time: 190.08ms
[NCCL Rank 1] Total Simulation Time: 190.10ms
[NCCL Rank 2] Total Simulation Time: 190.11ms
[NCCL Rank 3] Total Simulation Time: 190.12ms
[MPI Rank 0]: Shuffle 0 cost 123.41ms on average.
[MPI Rank 1]: Destroyed everthing!
Time Cost: 348503 us
Destroyed the simulator
[MPI Rank 0]: Destroyed everthing!
Time Cost: 348795 us
Destroyed the simulator
