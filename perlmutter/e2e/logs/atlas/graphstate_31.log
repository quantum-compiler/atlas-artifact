Num ranks: 2, myrank: 0
Num ranks: 2, myrank: 1
Use cached schedule
Compilation Done! 
Num Shuffles: 1
Num FUSION Kernel: 3
Num SHM Kernel: 2
Start Simulating...
Use cached schedule
Compilation Done! 
Num Shuffles: 1
Num FUSION Kernel: 3
Num SHM Kernel: 2
Start Simulating...
[warmup] size total:536870912
[warmup] size total:536870912
Init State Vectors on 4 devices
Init State Vectors on 4 devices
[NCCL Rank 0] Shuffle Time: 159.77ms
[NCCL Rank 1] Shuffle Time: 160.25ms
[NCCL Rank 2] Shuffle Time: 160.26ms
[NCCL Rank 3] Shuffle Time: 160.27ms
[NCCL Rank 4] Shuffle Time: 154.59ms
[NCCL Rank 5] Shuffle Time: 154.73ms
[NCCL Rank 6] Shuffle Time: 154.79ms
[NCCL Rank 7] Shuffle Time: 154.80ms
Finish Simulating! Total: 3 FUSE Kernel, 2 SHM Kernel, 1 Shuffles.
Finish Simulating! Total: 3 FUSE Kernel, 2 SHM Kernel, 1 Shuffles.
[NCCL Rank 4] Total Simulation Time: 251.26ms
[NCCL Rank 5] Total Simulation Time: 251.27ms
[NCCL Rank 6] Total Simulation Time: 251.28ms
[NCCL Rank 7] Total Simulation Time: 251.29ms
[NCCL Rank 0] Total Simulation Time: 251.38ms
[NCCL Rank 1] Total Simulation Time: 251.40ms
[NCCL Rank 2] Total Simulation Time: 251.42ms
[NCCL Rank 3] Total Simulation Time: 251.43ms
[MPI Rank 0]: Shuffle 0 cost 160.14ms on average.
[MPI Rank 1]: Destroyed everything!
Time Cost: 359936 us
Destroyed the simulator
[MPI Rank 0]: Destroyed everything!
Time Cost: 359917 us
Destroyed the simulator
