Num ranks: 4, myrank: 0
Num ranks: 4, myrank: 2
Num ranks: 4, myrank: 3
Num ranks: 4, myrank: 1
Use cached schedule
Use cached schedule
Use cached schedule
Use cached schedule
Compilation Done! 
Num Shuffles: 2
Num FUSION Kernel: 9
Num SHM Kernel: 3
Start Simulating...
Compilation Done! 
Num Shuffles: 2
Num FUSION Kernel: 9
Num SHM Kernel: 3
Start Simulating...
Compilation Done! 
Num Shuffles: 2
Num FUSION Kernel: 9
Num SHM Kernel: 3
Start Simulating...
Compilation Done! 
Num Shuffles: 2
Num FUSION Kernel: 9
Num SHM Kernel: 3
Start Simulating...
[warmup] size total:268435456
[warmup] size total:268435456
[warmup] size total:268435456
[warmup] size total:268435456
Init State Vectors on 4 devices
Init State Vectors on 4 devices
Init State Vectors on 4 devices
Init State Vectors on 4 devices
[NCCL Rank 0] Shuffle Time: 157.25ms
[NCCL Rank 1] Shuffle Time: 157.32ms
[NCCL Rank 8] Shuffle Time: 169.14ms
[NCCL Rank 9] Shuffle Time: 169.16ms
[NCCL Rank 10] Shuffle Time: 169.17ms
[NCCL Rank 11] Shuffle Time: 169.18ms
[NCCL Rank 2] Shuffle Time: 157.46ms
[NCCL Rank 3] Shuffle Time: 157.47ms
[NCCL Rank 4] Shuffle Time: 158.51ms
[NCCL Rank 5] Shuffle Time: 158.52ms
[NCCL Rank 6] Shuffle Time: 158.53ms
[NCCL Rank 12] Shuffle Time: 179.88ms
[NCCL Rank 13] Shuffle Time: 179.90ms
[NCCL Rank 14] Shuffle Time: 179.91ms
[NCCL Rank 7] Shuffle Time: 158.91ms
[NCCL Rank 15] Shuffle Time: 179.92ms
[NCCL Rank 8] Shuffle Time: 162.21ms
[NCCL Rank 0] Shuffle Time: 165.86ms
[NCCL Rank 1] Shuffle Time: 157.08ms
[NCCL Rank 9] Shuffle Time: 158.76ms
[NCCL Rank 2] Shuffle Time: 153.33ms
[NCCL Rank 10] Shuffle Time: 155.64ms
[NCCL Rank 11] Shuffle Time: 153.12ms
[NCCL Rank 3] Shuffle Time: 151.44ms
[NCCL Rank 12] Shuffle Time: 155.50ms
[NCCL Rank 13] Shuffle Time: 152.81ms
[NCCL Rank 14] Shuffle Time: 151.44ms
[NCCL Rank 4] Shuffle Time: 177.03ms
[NCCL Rank 5] Shuffle Time: 170.86ms
[NCCL Rank 6] Shuffle Time: 167.26ms
[NCCL Rank 15] Shuffle Time: 151.80ms
[NCCL Rank 7] Shuffle Time: 164.70ms
Finish Simulating! Total: 9 FUSE Kernel, 3 SHM Kernel, 2 Shuffles.
Finish Simulating! Total: 9 FUSE Kernel, 3 SHM Kernel, 2 Shuffles.
[NCCL Rank 8] Total Simulation Time: 565.76ms
[NCCL Rank 9] Total Simulation Time: 565.93ms
[NCCL Rank 10] Total Simulation Time: 566.09ms
[NCCL Rank 11] Total Simulation Time: 566.25ms
[NCCL Rank 0] Total Simulation Time: 568.64ms
[NCCL Rank 1] Total Simulation Time: 568.84ms
[NCCL Rank 2] Total Simulation Time: 569.02ms
[NCCL Rank 3] Total Simulation Time: 569.20ms
[MPI Rank 0]: Shuffle 0 cost 157.37ms on average.
[MPI Rank 0]: Shuffle 1 cost 156.93ms on average.
Finish Simulating! Total: 9 FUSE Kernel, 3 SHM Kernel, 2 Shuffles.
Finish Simulating! Total: 9 FUSE Kernel, 3 SHM Kernel, 2 Shuffles.
[NCCL Rank 4] Total Simulation Time: 584.10ms
[NCCL Rank 5] Total Simulation Time: 584.27ms
[NCCL Rank 6] Total Simulation Time: 584.44ms
[NCCL Rank 7] Total Simulation Time: 584.61ms
[NCCL Rank 12] Total Simulation Time: 588.02ms
[NCCL Rank 13] Total Simulation Time: 588.20ms
[NCCL Rank 14] Total Simulation Time: 588.39ms
[NCCL Rank 15] Total Simulation Time: 588.57ms
[MPI Rank 0]: Destroyed everything!
Time Cost: 676506 us
Destroyed the simulator
[MPI Rank 1]: Destroyed everything!
Time Cost: 712861 us
Destroyed the simulator
[MPI Rank 2]: Destroyed everything!
Time Cost: 742223 us
Destroyed the simulator
[MPI Rank 3]: Destroyed everything!
Time Cost: 763922 us
Destroyed the simulator
