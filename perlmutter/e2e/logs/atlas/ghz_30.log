Num ranks: 1, myrank: 0
Computed and cached schedule in 3.478 seconds.
Current Layout0: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 29, 26, 27, Start fusing gates...
Reset qubit group map
(26, 28) (27, 29) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,28,29,26,27,]
Fusing Kernel (2 gates): qubits [28, 29], gates fusion, qubits [28, 29], gates CircuitSeq {
  Q29 = h(Q29)
  [Q29, Q28] = cx(Q29, Q28)
}

Gate 0: [29, ]
Fusing gate 0(0) for rank 0
t 29
Matrix Multiplication (2, 1), mask 2
Fusing gate 0(0) for rank 1
t 29
Matrix Multiplication (2, 1), mask 2
Fusing gate 0(0) for rank 2
t 29
Matrix Multiplication (2, 1), mask 2
Fusing gate 0(0) for rank 3
t 29
Matrix Multiplication (2, 1), mask 2
Gate 1: [29, 28, ]
Fusing gate 6(1) for rank 0
c,t 29,28
Matrix Multiplication (2, 2), mask 3
Fusing gate 6(1) for rank 1
c,t 29,28
Matrix Multiplication (2, 2), mask 3
Fusing gate 6(1) for rank 2
c,t 29,28
Matrix Multiplication (2, 2), mask 3
Fusing gate 6(1) for rank 3
c,t 29,28
Matrix Multiplication (2, 2), mask 3
Current Layout0: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, Start fusing gates...
Reset qubit group map
(23, 23) (24, 24) (25, 25) (26, 26) (27, 27) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,]
Fusing Kernel (5 gates): qubits [23, 24, 25, 26, 27], gates fusion, qubits [23, 24, 25, 26, 27], gates CircuitSeq {
  [Q28, Q27] = cx(Q28, Q27)
  [Q27, Q26] = cx(Q27, Q26)
  [Q26, Q25] = cx(Q26, Q25)
  [Q25, Q24] = cx(Q25, Q24)
  [Q24, Q23] = cx(Q24, Q23)
}

Gate 0: [28, 27, ]
Fusing gate 6(1) for rank 0
c,t 28,27
Fusing gate 6(1) for rank 1
c,t 28,27
Matrix Multiplication (5, 1), mask 16
Fusing gate 6(1) for rank 2
c,t 28,27
Fusing gate 6(1) for rank 3
c,t 28,27
Matrix Multiplication (5, 1), mask 16
Gate 1: [27, 26, ]
Fusing gate 6(1) for rank 0
c,t 27,26
Matrix Multiplication (5, 2), mask 24
Fusing gate 6(1) for rank 1
c,t 27,26
Matrix Multiplication (5, 2), mask 24
Fusing gate 6(1) for rank 2
c,t 27,26
Matrix Multiplication (5, 2), mask 24
Fusing gate 6(1) for rank 3
c,t 27,26
Matrix Multiplication (5, 2), mask 24
Gate 2: [26, 25, ]
Fusing gate 6(1) for rank 0
c,t 26,25
Matrix Multiplication (5, 2), mask 12
Fusing gate 6(1) for rank 1
c,t 26,25
Matrix Multiplication (5, 2), mask 12
Fusing gate 6(1) for rank 2
c,t 26,25
Matrix Multiplication (5, 2), mask 12
Fusing gate 6(1) for rank 3
c,t 26,25
Matrix Multiplication (5, 2), mask 12
Gate 3: [25, 24, ]
Fusing gate 6(1) for rank 0
c,t 25,24
Matrix Multiplication (5, 2), mask 6
Fusing gate 6(1) for rank 1
c,t 25,24
Matrix Multiplication (5, 2), mask 6
Fusing gate 6(1) for rank 2
c,t 25,24
Matrix Multiplication (5, 2), mask 6
Fusing gate 6(1) for rank 3
c,t 25,24
Matrix Multiplication (5, 2), mask 6
Gate 4: [24, 23, ]
Fusing gate 6(1) for rank 0
c,t 24,23
Matrix Multiplication (5, 2), mask 3
Fusing gate 6(1) for rank 1
c,t 24,23
Matrix Multiplication (5, 2), mask 3
Fusing gate 6(1) for rank 2
c,t 24,23
Matrix Multiplication (5, 2), mask 3
Fusing gate 6(1) for rank 3
c,t 24,23
Matrix Multiplication (5, 2), mask 3
SHM Kernel Physical (6): [ 17,18,19,20,21,22]
shared_memory, qubits [17, 18, 19, 20, 21, 22], gates CircuitSeq {
  [Q23, Q22] = cx(Q23, Q22)
  [Q22, Q21] = cx(Q22, Q21)
  [Q21, Q20] = cx(Q21, Q20)
  [Q20, Q19] = cx(Q20, Q19)
  [Q19, Q18] = cx(Q19, Q18)
  [Q18, Q17] = cx(Q18, Q17)
}

SHM Kernel Physical (7): [ 10,11,12,13,14,15,16]
shared_memory, qubits [10, 11, 12, 13, 14, 15, 16], gates CircuitSeq {
  [Q17, Q16] = cx(Q17, Q16)
  [Q16, Q15] = cx(Q16, Q15)
  [Q15, Q14] = cx(Q15, Q14)
  [Q14, Q13] = cx(Q14, Q13)
  [Q13, Q12] = cx(Q13, Q12)
  [Q12, Q11] = cx(Q12, Q11)
  [Q11, Q10] = cx(Q11, Q10)
}

SHM Kernel Physical (10): [ 0,1,2,3,4,5,6,7,8,9]
shared_memory, qubits [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], gates CircuitSeq {
  [Q10, Q9] = cx(Q10, Q9)
  [Q9, Q8] = cx(Q9, Q8)
  [Q8, Q7] = cx(Q8, Q7)
  [Q7, Q6] = cx(Q7, Q6)
  [Q6, Q5] = cx(Q6, Q5)
  [Q5, Q4] = cx(Q5, Q4)
  [Q4, Q3] = cx(Q4, Q3)
  [Q3, Q2] = cx(Q3, Q2)
  [Q2, Q1] = cx(Q2, Q1)
  [Q1, Q0] = cx(Q1, Q0)
}

Compilation Done! 
Num Shuffles: 1
Num FUSION Kernel: 2
Num SHM Kernel: 3
Start Simulating...
[warmup] size total:1073741824
NCCL comm nRanks: 4, i am 0
I am 0, mask 3, I am sending to 0
I am 0, mask 3, I am sending to 1
I am 0, mask 3, I am sending to 2
I am 0, mask 3, I am sending to 3
NCCL comm nRanks: 4, i am 1
I am 1, mask 3, I am sending to 0
I am 1, mask 3, I am sending to 1
I am 1, mask 3, I am sending to 2
I am 1, mask 3, I am sending to 3
NCCL comm nRanks: 4, i am 2
I am 2, mask 3, I am sending to 0
I am 2, mask 3, I am sending to 1
I am 2, mask 3, I am sending to 2
I am 2, mask 3, I am sending to 3
NCCL comm nRanks: 4, i am 3
I am 3, mask 3, I am sending to 0
I am 3, mask 3, I am sending to 1
I am 3, mask 3, I am sending to 2
I am 3, mask 3, I am sending to 3
hello checking all2all
Init State Vectors!
Using NCCL for cross-node shuffle
My physical id:0, 3
NCCL comm nRanks: 4, i am 0
I am 0, mask 3, I am sending to 0
I am 0, mask 3, I am sending to 1
I am 0, mask 3, I am sending to 2
I am 0, mask 3, I am sending to 3
My physical id:1, 3
NCCL comm nRanks: 4, i am 1
I am 1, mask 3, I am sending to 0
I am 1, mask 3, I am sending to 1
I am 1, mask 3, I am sending to 2
I am 1, mask 3, I am sending to 3
My physical id:2, 3
NCCL comm nRanks: 4, i am 2
I am 2, mask 3, I am sending to 0
I am 2, mask 3, I am sending to 1
I am 2, mask 3, I am sending to 2
I am 2, mask 3, I am sending to 3
My physical id:3, 3
NCCL comm nRanks: 4, i am 3
I am 3, mask 3, I am sending to 0
I am 3, mask 3, I am sending to 1
I am 3, mask 3, I am sending to 2
I am 3, mask 3, I am sending to 3
[NCCL Rank 0] Shuffle Time: 18.15ms
[NCCL Rank 1] Shuffle Time: 18.16ms
[NCCL Rank 2] Shuffle Time: 18.17ms
[NCCL Rank 3] Shuffle Time: 18.17ms
Finish Simulating! Total: 2 FUSE Kernel, 3 SHM Kernel, 1 Shuffles.
[NCCL Rank 0] Total Simulation Time: 73.45ms
[NCCL Rank 1] Total Simulation Time: 74.18ms
[NCCL Rank 2] Total Simulation Time: 77.74ms
[NCCL Rank 3] Total Simulation Time: 77.75ms
[MPI Rank 0]: Shuffle 0 cost 18.16ms on average.
Solving ILP for num_qubits=30, num_local_qubits=28, num_global_qubits=0, num_iterations=1...
Available solvers: ['PULP_CBC_CMD', 'HiGHS_CMD']
Running HiGHS 1.5.0 [date: 2023-11-09, git hash: 8a114449a]
Copyright (c) 2022 HiGHS under MIT licence terms
Number of BV entries in BOUNDS section is 120
MIP  6996f43e9b794150af94a17b170c6d84-pulp has 210 rows; 121 cols; 446 nonzeros; 120 integer variables
Presolving model
119 rows, 30 cols, 60 nonzeros
Presolve: Infeasible

Solving report
  Status            Infeasible
  Primal bound      inf
  Dual bound        -inf
  Gap               inf
  Solution status   -
  Timing            0.00 (total)
                    0.00 (presolve)
                    0.00 (postsolve)
  Nodes             0
  LP iterations     0 (total)
                    0 (strong br.)
                    0 (separation)
                    0 (heuristics)
Writing the solution to /tmp/6996f43e9b794150af94a17b170c6d84-pulp.sol
Solving ILP for num_qubits=30, num_local_qubits=28, num_global_qubits=0, num_iterations=2...
Available solvers: ['PULP_CBC_CMD', 'HiGHS_CMD']
Running HiGHS 1.5.0 [date: 2023-11-09, git hash: 8a114449a]
Copyright (c) 2022 HiGHS under MIT licence terms
Number of BV entries in BOUNDS section is 270
MIP  12de9502e1dd412183e1b7453b4a9615-pulp has 391 rows; 270 cols; 954 nonzeros; 270 integer variables
Presolving model
239 rows, 120 cols, 388 nonzeros
119 rows, 118 cols, 324 nonzeros
105 rows, 107 cols, 287 nonzeros
Objective function is integral with scale 1

Solving MIP model with:
   105 rows
   107 cols (106 binary, 1 integer, 0 implied int., 0 continuous)
   287 nonzeros

        Nodes      |    B&B Tree     |            Objective Bounds              |  Dynamic Constraints |       Work      
     Proc. InQueue |  Leaves   Expl. | BestBound       BestSol              Gap |   Cuts   InLp Confl. | LpIters     Time

         0       0         0   0.00%   0               inf                  inf        0      0      0         0     0.0s
 R       0       0         0   0.00%   0               2                100.00%        0      0      0        75     0.0s

10.3% inactive integer columns, restarting

Solving report
  Status            Optimal
  Primal bound      2
  Dual bound        2
  Gap               0% (tolerance: 0.01%)
  Solution status   feasible
                    2 (objective)
                    0 (bound viol.)
                    0 (int. viol.)
                    0 (row viol.)
  Timing            0.02 (total)
                    0.01 (presolve)
                    0.00 (postsolve)
  Nodes             0
  LP iterations     136 (total)
                    0 (strong br.)
                    46 (separation)
                    15 (heuristics)
Writing the solution to /tmp/12de9502e1dd412183e1b7453b4a9615-pulp.sol
[MPI Rank 0]: Destroyed everthing!
Time Cost: 299752 us
Destroyed the simulator
