Num ranks: 1, myrank: 0
Computed and cached schedule in 0.214 seconds.
Current Layout0: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, Start fusing gates...
Reset qubit group map
(23, 23) (24, 24) (25, 25) (26, 26) (27, 27) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,]
Fusing Kernel (17 gates): qubits [23, 24, 25, 26, 27], gates fusion, qubits [23, 24, 25, 26, 27], gates CircuitSeq {
  Q27 = x(Q27)
  Q26 = ry(Q26, P26)
  [Q27, Q26] = cz[0](Q27, Q26)
  Q26 = ry(Q26, P27)
  Q25 = ry(Q25, P25)
  [Q26, Q25] = cz(Q26, Q25)
  Q25 = ry(Q25, P28)
  Q24 = ry(Q24, P24)
  [Q25, Q24] = cz(Q25, Q24)
  Q24 = ry(Q24, P29)
  Q23 = ry(Q23, P23)
  [Q24, Q23] = cz(Q24, Q23)
  Q23 = ry(Q23, P30)
  [Q26, Q27] = cx(Q26, Q27)
  [Q25, Q26] = cx(Q25, Q26)
  [Q24, Q25] = cx(Q24, Q25)
  [Q23, Q24] = cx(Q23, Q24)
}

Gate 0: [27, ]
Fusing gate 1(0) for rank 0
t 27
Matrix Multiplication (5, 1), mask 16
Gate 1: [26, ]
Fusing gate 4(0) for rank 0
t 26
Matrix Multiplication (5, 1), mask 8
Gate 2: [27, 26, ]
Fusing gate 25(1) for rank 0
c,t 27,26
Matrix Multiplication (5, 2), mask 24
Gate 3: [26, ]
Fusing gate 4(0) for rank 0
t 26
Matrix Multiplication (5, 1), mask 8
Gate 4: [25, ]
Fusing gate 4(0) for rank 0
t 25
Matrix Multiplication (5, 1), mask 4
Gate 5: [26, 25, ]
Fusing gate 25(1) for rank 0
c,t 26,25
Matrix Multiplication (5, 2), mask 12
Gate 6: [25, ]
Fusing gate 4(0) for rank 0
t 25
Matrix Multiplication (5, 1), mask 4
Gate 7: [24, ]
Fusing gate 4(0) for rank 0
t 24
Matrix Multiplication (5, 1), mask 2
Gate 8: [25, 24, ]
Fusing gate 25(1) for rank 0
c,t 25,24
Matrix Multiplication (5, 2), mask 6
Gate 9: [24, ]
Fusing gate 4(0) for rank 0
t 24
Matrix Multiplication (5, 1), mask 2
Gate 10: [23, ]
Fusing gate 4(0) for rank 0
t 23
Matrix Multiplication (5, 1), mask 1
Gate 11: [24, 23, ]
Fusing gate 25(1) for rank 0
c,t 24,23
Matrix Multiplication (5, 2), mask 3
Gate 12: [23, ]
Fusing gate 4(0) for rank 0
t 23
Matrix Multiplication (5, 1), mask 1
Gate 13: [26, 27, ]
Fusing gate 6(1) for rank 0
c,t 26,27
Matrix Multiplication (5, 2), mask 24
Gate 14: [25, 26, ]
Fusing gate 6(1) for rank 0
c,t 25,26
Matrix Multiplication (5, 2), mask 12
Gate 15: [24, 25, ]
Fusing gate 6(1) for rank 0
c,t 24,25
Matrix Multiplication (5, 2), mask 6
Gate 16: [23, 24, ]
Fusing gate 6(1) for rank 0
c,t 23,24
Matrix Multiplication (5, 2), mask 3
Start fusing gates...
Reset qubit group map
(19, 19) (20, 20) (21, 21) (22, 22) (23, 23) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,]
Fusing Kernel (16 gates): qubits [19, 20, 21, 22, 23], gates fusion, qubits [19, 20, 21, 22, 23], gates CircuitSeq {
  Q22 = ry(Q22, P22)
  [Q23, Q22] = cz(Q23, Q22)
  Q22 = ry(Q22, P31)
  Q21 = ry(Q21, P21)
  [Q22, Q21] = cz(Q22, Q21)
  Q21 = ry(Q21, P32)
  Q20 = ry(Q20, P20)
  [Q21, Q20] = cz(Q21, Q20)
  Q20 = ry(Q20, P33)
  Q19 = ry(Q19, P19)
  [Q20, Q19] = cz(Q20, Q19)
  Q19 = ry(Q19, P34)
  [Q22, Q23] = cx(Q22, Q23)
  [Q21, Q22] = cx(Q21, Q22)
  [Q20, Q21] = cx(Q20, Q21)
  [Q19, Q20] = cx(Q19, Q20)
}

Gate 0: [22, ]
Fusing gate 4(0) for rank 0
t 22
Matrix Multiplication (5, 1), mask 8
Gate 1: [23, 22, ]
Fusing gate 25(1) for rank 0
c,t 23,22
Matrix Multiplication (5, 2), mask 24
Gate 2: [22, ]
Fusing gate 4(0) for rank 0
t 22
Matrix Multiplication (5, 1), mask 8
Gate 3: [21, ]
Fusing gate 4(0) for rank 0
t 21
Matrix Multiplication (5, 1), mask 4
Gate 4: [22, 21, ]
Fusing gate 25(1) for rank 0
c,t 22,21
Matrix Multiplication (5, 2), mask 12
Gate 5: [21, ]
Fusing gate 4(0) for rank 0
t 21
Matrix Multiplication (5, 1), mask 4
Gate 6: [20, ]
Fusing gate 4(0) for rank 0
t 20
Matrix Multiplication (5, 1), mask 2
Gate 7: [21, 20, ]
Fusing gate 25(1) for rank 0
c,t 21,20
Matrix Multiplication (5, 2), mask 6
Gate 8: [20, ]
Fusing gate 4(0) for rank 0
t 20
Matrix Multiplication (5, 1), mask 2
Gate 9: [19, ]
Fusing gate 4(0) for rank 0
t 19
Matrix Multiplication (5, 1), mask 1
Gate 10: [20, 19, ]
Fusing gate 25(1) for rank 0
c,t 20,19
Matrix Multiplication (5, 2), mask 3
Gate 11: [19, ]
Fusing gate 4(0) for rank 0
t 19
Matrix Multiplication (5, 1), mask 1
Gate 12: [22, 23, ]
Fusing gate 6(1) for rank 0
c,t 22,23
Matrix Multiplication (5, 2), mask 24
Gate 13: [21, 22, ]
Fusing gate 6(1) for rank 0
c,t 21,22
Matrix Multiplication (5, 2), mask 12
Gate 14: [20, 21, ]
Fusing gate 6(1) for rank 0
c,t 20,21
Matrix Multiplication (5, 2), mask 6
Gate 15: [19, 20, ]
Fusing gate 6(1) for rank 0
c,t 19,20
Matrix Multiplication (5, 2), mask 3
Start fusing gates...
Reset qubit group map
(15, 15) (16, 16) (17, 17) (18, 18) (19, 19) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,]
Fusing Kernel (16 gates): qubits [15, 16, 17, 18, 19], gates fusion, qubits [15, 16, 17, 18, 19], gates CircuitSeq {
  Q18 = ry(Q18, P18)
  [Q19, Q18] = cz(Q19, Q18)
  Q18 = ry(Q18, P35)
  Q17 = ry(Q17, P17)
  [Q18, Q17] = cz(Q18, Q17)
  Q17 = ry(Q17, P36)
  Q16 = ry(Q16, P16)
  [Q17, Q16] = cz(Q17, Q16)
  Q16 = ry(Q16, P37)
  Q15 = ry(Q15, P15)
  [Q16, Q15] = cz(Q16, Q15)
  Q15 = ry(Q15, P38)
  [Q18, Q19] = cx(Q18, Q19)
  [Q17, Q18] = cx(Q17, Q18)
  [Q16, Q17] = cx(Q16, Q17)
  [Q15, Q16] = cx(Q15, Q16)
}

Gate 0: [18, ]
Fusing gate 4(0) for rank 0
t 18
Matrix Multiplication (5, 1), mask 8
Gate 1: [19, 18, ]
Fusing gate 25(1) for rank 0
c,t 19,18
Matrix Multiplication (5, 2), mask 24
Gate 2: [18, ]
Fusing gate 4(0) for rank 0
t 18
Matrix Multiplication (5, 1), mask 8
Gate 3: [17, ]
Fusing gate 4(0) for rank 0
t 17
Matrix Multiplication (5, 1), mask 4
Gate 4: [18, 17, ]
Fusing gate 25(1) for rank 0
c,t 18,17
Matrix Multiplication (5, 2), mask 12
Gate 5: [17, ]
Fusing gate 4(0) for rank 0
t 17
Matrix Multiplication (5, 1), mask 4
Gate 6: [16, ]
Fusing gate 4(0) for rank 0
t 16
Matrix Multiplication (5, 1), mask 2
Gate 7: [17, 16, ]
Fusing gate 25(1) for rank 0
c,t 17,16
Matrix Multiplication (5, 2), mask 6
Gate 8: [16, ]
Fusing gate 4(0) for rank 0
t 16
Matrix Multiplication (5, 1), mask 2
Gate 9: [15, ]
Fusing gate 4(0) for rank 0
t 15
Matrix Multiplication (5, 1), mask 1
Gate 10: [16, 15, ]
Fusing gate 25(1) for rank 0
c,t 16,15
Matrix Multiplication (5, 2), mask 3
Gate 11: [15, ]
Fusing gate 4(0) for rank 0
t 15
Matrix Multiplication (5, 1), mask 1
Gate 12: [18, 19, ]
Fusing gate 6(1) for rank 0
c,t 18,19
Matrix Multiplication (5, 2), mask 24
Gate 13: [17, 18, ]
Fusing gate 6(1) for rank 0
c,t 17,18
Matrix Multiplication (5, 2), mask 12
Gate 14: [16, 17, ]
Fusing gate 6(1) for rank 0
c,t 16,17
Matrix Multiplication (5, 2), mask 6
Gate 15: [15, 16, ]
Fusing gate 6(1) for rank 0
c,t 15,16
Matrix Multiplication (5, 2), mask 3
Start fusing gates...
Reset qubit group map
(11, 11) (12, 12) (13, 13) (14, 14) (15, 15) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,]
Fusing Kernel (16 gates): qubits [11, 12, 13, 14, 15], gates fusion, qubits [11, 12, 13, 14, 15], gates CircuitSeq {
  Q14 = ry(Q14, P14)
  [Q15, Q14] = cz(Q15, Q14)
  Q14 = ry(Q14, P39)
  Q13 = ry(Q13, P13)
  [Q14, Q13] = cz(Q14, Q13)
  Q13 = ry(Q13, P40)
  Q12 = ry(Q12, P12)
  [Q13, Q12] = cz(Q13, Q12)
  Q12 = ry(Q12, P41)
  Q11 = ry(Q11, P11)
  [Q12, Q11] = cz(Q12, Q11)
  Q11 = ry(Q11, P42)
  [Q14, Q15] = cx(Q14, Q15)
  [Q13, Q14] = cx(Q13, Q14)
  [Q12, Q13] = cx(Q12, Q13)
  [Q11, Q12] = cx(Q11, Q12)
}

Gate 0: [14, ]
Fusing gate 4(0) for rank 0
t 14
Matrix Multiplication (5, 1), mask 8
Gate 1: [15, 14, ]
Fusing gate 25(1) for rank 0
c,t 15,14
Matrix Multiplication (5, 2), mask 24
Gate 2: [14, ]
Fusing gate 4(0) for rank 0
t 14
Matrix Multiplication (5, 1), mask 8
Gate 3: [13, ]
Fusing gate 4(0) for rank 0
t 13
Matrix Multiplication (5, 1), mask 4
Gate 4: [14, 13, ]
Fusing gate 25(1) for rank 0
c,t 14,13
Matrix Multiplication (5, 2), mask 12
Gate 5: [13, ]
Fusing gate 4(0) for rank 0
t 13
Matrix Multiplication (5, 1), mask 4
Gate 6: [12, ]
Fusing gate 4(0) for rank 0
t 12
Matrix Multiplication (5, 1), mask 2
Gate 7: [13, 12, ]
Fusing gate 25(1) for rank 0
c,t 13,12
Matrix Multiplication (5, 2), mask 6
Gate 8: [12, ]
Fusing gate 4(0) for rank 0
t 12
Matrix Multiplication (5, 1), mask 2
Gate 9: [11, ]
Fusing gate 4(0) for rank 0
t 11
Matrix Multiplication (5, 1), mask 1
Gate 10: [12, 11, ]
Fusing gate 25(1) for rank 0
c,t 12,11
Matrix Multiplication (5, 2), mask 3
Gate 11: [11, ]
Fusing gate 4(0) for rank 0
t 11
Matrix Multiplication (5, 1), mask 1
Gate 12: [14, 15, ]
Fusing gate 6(1) for rank 0
c,t 14,15
Matrix Multiplication (5, 2), mask 24
Gate 13: [13, 14, ]
Fusing gate 6(1) for rank 0
c,t 13,14
Matrix Multiplication (5, 2), mask 12
Gate 14: [12, 13, ]
Fusing gate 6(1) for rank 0
c,t 12,13
Matrix Multiplication (5, 2), mask 6
Gate 15: [11, 12, ]
Fusing gate 6(1) for rank 0
c,t 11,12
Matrix Multiplication (5, 2), mask 3
Start fusing gates...
Reset qubit group map
(8, 8) (9, 9) (10, 10) (11, 11) (12, 12) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,]
Fusing Kernel (12 gates): qubits [8, 9, 10, 11, 12], gates fusion, qubits [8, 9, 10, 11, 12], gates CircuitSeq {
  Q10 = ry(Q10, P10)
  [Q11, Q10] = cz(Q11, Q10)
  Q10 = ry(Q10, P43)
  Q9 = ry(Q9, P9)
  [Q10, Q9] = cz(Q10, Q9)
  Q9 = ry(Q9, P44)
  [Q10, Q11] = cx(Q10, Q11)
  Q8 = ry(Q8, P8)
  [Q9, Q8] = cz(Q9, Q8)
  Q8 = ry(Q8, P45)
  [Q9, Q10] = cx(Q9, Q10)
  [Q8, Q9] = cx(Q8, Q9)
}

Gate 0: [10, ]
Fusing gate 4(0) for rank 0
t 10
Matrix Multiplication (5, 1), mask 4
Gate 1: [11, 10, ]
Fusing gate 25(1) for rank 0
c,t 11,10
Matrix Multiplication (5, 2), mask 12
Gate 2: [10, ]
Fusing gate 4(0) for rank 0
t 10
Matrix Multiplication (5, 1), mask 4
Gate 3: [9, ]
Fusing gate 4(0) for rank 0
t 9
Matrix Multiplication (5, 1), mask 2
Gate 4: [10, 9, ]
Fusing gate 25(1) for rank 0
c,t 10,9
Matrix Multiplication (5, 2), mask 6
Gate 5: [9, ]
Fusing gate 4(0) for rank 0
t 9
Matrix Multiplication (5, 1), mask 2
Gate 6: [10, 11, ]
Fusing gate 6(1) for rank 0
c,t 10,11
Matrix Multiplication (5, 2), mask 12
Gate 7: [8, ]
Fusing gate 4(0) for rank 0
t 8
Matrix Multiplication (5, 1), mask 1
Gate 8: [9, 8, ]
Fusing gate 25(1) for rank 0
c,t 9,8
Matrix Multiplication (5, 2), mask 3
Gate 9: [8, ]
Fusing gate 4(0) for rank 0
t 8
Matrix Multiplication (5, 1), mask 1
Gate 10: [9, 10, ]
Fusing gate 6(1) for rank 0
c,t 9,10
Matrix Multiplication (5, 2), mask 6
Gate 11: [8, 9, ]
Fusing gate 6(1) for rank 0
c,t 8,9
Matrix Multiplication (5, 2), mask 3
SHM Kernel Physical (32): [ 0,1,2,3,4,5,6,7,8,9]
shared_memory, qubits [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], gates CircuitSeq {
  Q7 = ry(Q7, P7)
  [Q8, Q7] = cz(Q8, Q7)
  Q7 = ry(Q7, P46)
  Q6 = ry(Q6, P6)
  [Q7, Q6] = cz(Q7, Q6)
  Q6 = ry(Q6, P47)
  Q5 = ry(Q5, P5)
  [Q6, Q5] = cz(Q6, Q5)
  Q5 = ry(Q5, P48)
  Q4 = ry(Q4, P4)
  [Q5, Q4] = cz(Q5, Q4)
  Q4 = ry(Q4, P49)
  Q3 = ry(Q3, P3)
  [Q4, Q3] = cz(Q4, Q3)
  Q3 = ry(Q3, P50)
  Q2 = ry(Q2, P2)
  [Q3, Q2] = cz(Q3, Q2)
  Q2 = ry(Q2, P51)
  Q1 = ry(Q1, P1)
  [Q2, Q1] = cz(Q2, Q1)
  Q1 = ry(Q1, P52)
  Q0 = ry(Q0, P0)
  [Q1, Q0] = cz(Q1, Q0)
  Q0 = ry(Q0, P53)
  [Q7, Q8] = cx(Q7, Q8)
  [Q6, Q7] = cx(Q6, Q7)
  [Q5, Q6] = cx(Q5, Q6)
  [Q4, Q5] = cx(Q4, Q5)
  [Q3, Q4] = cx(Q3, Q4)
  [Q2, Q3] = cx(Q2, Q3)
  [Q1, Q2] = cx(Q1, Q2)
  [Q0, Q1] = cx(Q0, Q1)
}

Compilation Done! 
Num Shuffles: 0
Num FUSION Kernel: 5
Num SHM Kernel: 1
Start Simulating...
[warmup] size total:4294967296
NCCL comm nRanks: 1, i am 0
I am 0, mask 0, I am sending to 0
hello checking all2all
Init State Vectors!
Finish Simulating! Total: 5 FUSE Kernel, 1 SHM Kernel, 0 Shuffles.
[NCCL Rank 0] Total Simulation Time: 50.01ms
[MPI Rank 0]: Destroyed everthing!
Time Cost: 64913 us
Destroyed the simulator
