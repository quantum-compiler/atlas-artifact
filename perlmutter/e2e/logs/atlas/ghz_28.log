Num ranks: 1, myrank: 0
Computed and cached schedule in 0.108 seconds.
Current Layout0: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, Start fusing gates...
Reset qubit group map
(23, 23) (24, 24) (25, 25) (26, 26) (27, 27) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,]
Fusing Kernel (5 gates): qubits [23, 24, 25, 26, 27], gates fusion, qubits [23, 24, 25, 26, 27], gates CircuitSeq {
  Q27 = h(Q27)
  [Q27, Q26] = cx(Q27, Q26)
  [Q26, Q25] = cx(Q26, Q25)
  [Q25, Q24] = cx(Q25, Q24)
  [Q24, Q23] = cx(Q24, Q23)
}

Gate 0: [27, ]
Fusing gate 0(0) for rank 0
t 27
Matrix Multiplication (5, 1), mask 16
Gate 1: [27, 26, ]
Fusing gate 6(1) for rank 0
c,t 27,26
Matrix Multiplication (5, 2), mask 24
Gate 2: [26, 25, ]
Fusing gate 6(1) for rank 0
c,t 26,25
Matrix Multiplication (5, 2), mask 12
Gate 3: [25, 24, ]
Fusing gate 6(1) for rank 0
c,t 25,24
Matrix Multiplication (5, 2), mask 6
Gate 4: [24, 23, ]
Fusing gate 6(1) for rank 0
c,t 24,23
Matrix Multiplication (5, 2), mask 3
SHM Kernel Physical (6): [ 17,18,19,20,21,22]
shared_memory, qubits [17, 18, 19, 20, 21, 22], gates CircuitSeq {
  [Q23, Q22] = cx(Q23, Q22)
  [Q22, Q21] = cx(Q22, Q21)
  [Q21, Q20] = cx(Q21, Q20)
  [Q20, Q19] = cx(Q20, Q19)
  [Q19, Q18] = cx(Q19, Q18)
  [Q18, Q17] = cx(Q18, Q17)
}

SHM Kernel Physical (7): [ 10,11,12,13,14,15,16]
shared_memory, qubits [10, 11, 12, 13, 14, 15, 16], gates CircuitSeq {
  [Q17, Q16] = cx(Q17, Q16)
  [Q16, Q15] = cx(Q16, Q15)
  [Q15, Q14] = cx(Q15, Q14)
  [Q14, Q13] = cx(Q14, Q13)
  [Q13, Q12] = cx(Q13, Q12)
  [Q12, Q11] = cx(Q12, Q11)
  [Q11, Q10] = cx(Q11, Q10)
}

SHM Kernel Physical (10): [ 0,1,2,3,4,5,6,7,8,9]
shared_memory, qubits [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], gates CircuitSeq {
  [Q10, Q9] = cx(Q10, Q9)
  [Q9, Q8] = cx(Q9, Q8)
  [Q8, Q7] = cx(Q8, Q7)
  [Q7, Q6] = cx(Q7, Q6)
  [Q6, Q5] = cx(Q6, Q5)
  [Q5, Q4] = cx(Q5, Q4)
  [Q4, Q3] = cx(Q4, Q3)
  [Q3, Q2] = cx(Q3, Q2)
  [Q2, Q1] = cx(Q2, Q1)
  [Q1, Q0] = cx(Q1, Q0)
}

Compilation Done! 
Num Shuffles: 0
Num FUSION Kernel: 1
Num SHM Kernel: 3
Start Simulating...
[warmup] size total:4294967296
NCCL comm nRanks: 1, i am 0
I am 0, mask 0, I am sending to 0
hello checking all2all
Init State Vectors!
Finish Simulating! Total: 1 FUSE Kernel, 3 SHM Kernel, 0 Shuffles.
[NCCL Rank 0] Total Simulation Time: 26.38ms
[MPI Rank 0]: Destroyed everthing!
Time Cost: 46909 us
Destroyed the simulator
