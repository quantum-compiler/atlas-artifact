Num ranks: 1, myrank: 0
Computed and cached schedule in 0.106 seconds.
Current Layout0: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, Start fusing gates...
Reset qubit group map
(0, 0) (1, 1) (2, 2) (3, 3) (27, 27) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,]
Fusing Kernel (13 gates): qubits [0, 1, 2, 3, 27], gates fusion, qubits [0, 1, 2, 3, 27], gates CircuitSeq {
  Q27 = u2(Q27, P1, P1)
  Q0 = u2(Q0, P0, P0)
  [Q0, Q27] = cx(Q0, Q27)
  Q0 = u2(Q0, P1, P1)
  Q1 = h(Q1)
  [Q1, Q27] = cx(Q1, Q27)
  Q1 = h(Q1)
  Q2 = h(Q2)
  [Q2, Q27] = cx(Q2, Q27)
  Q2 = h(Q2)
  Q3 = h(Q3)
  [Q3, Q27] = cx(Q3, Q27)
  Q3 = h(Q3)
}

Gate 0: [27, ]
Fusing gate 22(0) for rank 0
t 27
Matrix Multiplication (5, 1), mask 16
Gate 1: [0, ]
Fusing gate 22(0) for rank 0
t 0
Matrix Multiplication (5, 1), mask 1
Gate 2: [0, 27, ]
Fusing gate 6(1) for rank 0
c,t 0,27
Matrix Multiplication (5, 2), mask 17
Gate 3: [0, ]
Fusing gate 22(0) for rank 0
t 0
Matrix Multiplication (5, 1), mask 1
Gate 4: [1, ]
Fusing gate 0(0) for rank 0
t 1
Matrix Multiplication (5, 1), mask 2
Gate 5: [1, 27, ]
Fusing gate 6(1) for rank 0
c,t 1,27
Matrix Multiplication (5, 2), mask 18
Gate 6: [1, ]
Fusing gate 0(0) for rank 0
t 1
Matrix Multiplication (5, 1), mask 2
Gate 7: [2, ]
Fusing gate 0(0) for rank 0
t 2
Matrix Multiplication (5, 1), mask 4
Gate 8: [2, 27, ]
Fusing gate 6(1) for rank 0
c,t 2,27
Matrix Multiplication (5, 2), mask 20
Gate 9: [2, ]
Fusing gate 0(0) for rank 0
t 2
Matrix Multiplication (5, 1), mask 4
Gate 10: [3, ]
Fusing gate 0(0) for rank 0
t 3
Matrix Multiplication (5, 1), mask 8
Gate 11: [3, 27, ]
Fusing gate 6(1) for rank 0
c,t 3,27
Matrix Multiplication (5, 2), mask 24
Gate 12: [3, ]
Fusing gate 0(0) for rank 0
t 3
Matrix Multiplication (5, 1), mask 8
Start fusing gates...
Reset qubit group map
(4, 4) (5, 5) (6, 6) (7, 7) (27, 27) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,]
Fusing Kernel (12 gates): qubits [4, 5, 6, 7, 27], gates fusion, qubits [4, 5, 6, 7, 27], gates CircuitSeq {
  Q4 = h(Q4)
  [Q4, Q27] = cx(Q4, Q27)
  Q4 = h(Q4)
  Q5 = u2(Q5, P0, P0)
  [Q5, Q27] = cx(Q5, Q27)
  Q5 = u2(Q5, P1, P1)
  Q6 = h(Q6)
  [Q6, Q27] = cx(Q6, Q27)
  Q6 = h(Q6)
  Q7 = h(Q7)
  [Q7, Q27] = cx(Q7, Q27)
  Q7 = h(Q7)
}

Gate 0: [4, ]
Fusing gate 0(0) for rank 0
t 4
Matrix Multiplication (5, 1), mask 1
Gate 1: [4, 27, ]
Fusing gate 6(1) for rank 0
c,t 4,27
Matrix Multiplication (5, 2), mask 17
Gate 2: [4, ]
Fusing gate 0(0) for rank 0
t 4
Matrix Multiplication (5, 1), mask 1
Gate 3: [5, ]
Fusing gate 22(0) for rank 0
t 5
Matrix Multiplication (5, 1), mask 2
Gate 4: [5, 27, ]
Fusing gate 6(1) for rank 0
c,t 5,27
Matrix Multiplication (5, 2), mask 18
Gate 5: [5, ]
Fusing gate 22(0) for rank 0
t 5
Matrix Multiplication (5, 1), mask 2
Gate 6: [6, ]
Fusing gate 0(0) for rank 0
t 6
Matrix Multiplication (5, 1), mask 4
Gate 7: [6, 27, ]
Fusing gate 6(1) for rank 0
c,t 6,27
Matrix Multiplication (5, 2), mask 20
Gate 8: [6, ]
Fusing gate 0(0) for rank 0
t 6
Matrix Multiplication (5, 1), mask 4
Gate 9: [7, ]
Fusing gate 0(0) for rank 0
t 7
Matrix Multiplication (5, 1), mask 8
Gate 10: [7, 27, ]
Fusing gate 6(1) for rank 0
c,t 7,27
Matrix Multiplication (5, 2), mask 24
Gate 11: [7, ]
Fusing gate 0(0) for rank 0
t 7
Matrix Multiplication (5, 1), mask 8
Start fusing gates...
Reset qubit group map
(8, 8) (9, 9) (10, 10) (11, 11) (27, 27) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,]
Fusing Kernel (12 gates): qubits [8, 9, 10, 11, 27], gates fusion, qubits [8, 9, 10, 11, 27], gates CircuitSeq {
  Q8 = h(Q8)
  [Q8, Q27] = cx(Q8, Q27)
  Q8 = h(Q8)
  Q9 = u2(Q9, P0, P0)
  [Q9, Q27] = cx(Q9, Q27)
  Q9 = u2(Q9, P1, P1)
  Q10 = h(Q10)
  [Q10, Q27] = cx(Q10, Q27)
  Q10 = h(Q10)
  Q11 = u2(Q11, P0, P0)
  [Q11, Q27] = cx(Q11, Q27)
  Q11 = u2(Q11, P1, P1)
}

Gate 0: [8, ]
Fusing gate 0(0) for rank 0
t 8
Matrix Multiplication (5, 1), mask 1
Gate 1: [8, 27, ]
Fusing gate 6(1) for rank 0
c,t 8,27
Matrix Multiplication (5, 2), mask 17
Gate 2: [8, ]
Fusing gate 0(0) for rank 0
t 8
Matrix Multiplication (5, 1), mask 1
Gate 3: [9, ]
Fusing gate 22(0) for rank 0
t 9
Matrix Multiplication (5, 1), mask 2
Gate 4: [9, 27, ]
Fusing gate 6(1) for rank 0
c,t 9,27
Matrix Multiplication (5, 2), mask 18
Gate 5: [9, ]
Fusing gate 22(0) for rank 0
t 9
Matrix Multiplication (5, 1), mask 2
Gate 6: [10, ]
Fusing gate 0(0) for rank 0
t 10
Matrix Multiplication (5, 1), mask 4
Gate 7: [10, 27, ]
Fusing gate 6(1) for rank 0
c,t 10,27
Matrix Multiplication (5, 2), mask 20
Gate 8: [10, ]
Fusing gate 0(0) for rank 0
t 10
Matrix Multiplication (5, 1), mask 4
Gate 9: [11, ]
Fusing gate 22(0) for rank 0
t 11
Matrix Multiplication (5, 1), mask 8
Gate 10: [11, 27, ]
Fusing gate 6(1) for rank 0
c,t 11,27
Matrix Multiplication (5, 2), mask 24
Gate 11: [11, ]
Fusing gate 22(0) for rank 0
t 11
Matrix Multiplication (5, 1), mask 8
Start fusing gates...
Reset qubit group map
(12, 12) (13, 13) (14, 14) (27, 27) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,]
Fusing Kernel (9 gates): qubits [12, 13, 14, 27], gates fusion, qubits [12, 13, 14, 27], gates CircuitSeq {
  Q12 = h(Q12)
  [Q12, Q27] = cx(Q12, Q27)
  Q12 = h(Q12)
  Q13 = u2(Q13, P0, P0)
  [Q13, Q27] = cx(Q13, Q27)
  Q13 = u2(Q13, P1, P1)
  Q14 = h(Q14)
  [Q14, Q27] = cx(Q14, Q27)
  Q14 = h(Q14)
}

Gate 0: [12, ]
Fusing gate 0(0) for rank 0
t 12
Matrix Multiplication (4, 1), mask 1
Gate 1: [12, 27, ]
Fusing gate 6(1) for rank 0
c,t 12,27
Matrix Multiplication (4, 2), mask 9
Gate 2: [12, ]
Fusing gate 0(0) for rank 0
t 12
Matrix Multiplication (4, 1), mask 1
Gate 3: [13, ]
Fusing gate 22(0) for rank 0
t 13
Matrix Multiplication (4, 1), mask 2
Gate 4: [13, 27, ]
Fusing gate 6(1) for rank 0
c,t 13,27
Matrix Multiplication (4, 2), mask 10
Gate 5: [13, ]
Fusing gate 22(0) for rank 0
t 13
Matrix Multiplication (4, 1), mask 2
Gate 6: [14, ]
Fusing gate 0(0) for rank 0
t 14
Matrix Multiplication (4, 1), mask 4
Gate 7: [14, 27, ]
Fusing gate 6(1) for rank 0
c,t 14,27
Matrix Multiplication (4, 2), mask 12
Gate 8: [14, ]
Fusing gate 0(0) for rank 0
t 14
Matrix Multiplication (4, 1), mask 4
Start fusing gates...
Reset qubit group map
(15, 15) (16, 16) (17, 17) (18, 18) (27, 27) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,]
Fusing Kernel (12 gates): qubits [15, 16, 17, 18, 27], gates fusion, qubits [15, 16, 17, 18, 27], gates CircuitSeq {
  Q15 = u2(Q15, P0, P0)
  [Q15, Q27] = cx(Q15, Q27)
  Q15 = u2(Q15, P1, P1)
  Q16 = u2(Q16, P0, P0)
  [Q16, Q27] = cx(Q16, Q27)
  Q16 = u2(Q16, P1, P1)
  Q17 = u2(Q17, P0, P0)
  [Q17, Q27] = cx(Q17, Q27)
  Q17 = u2(Q17, P1, P1)
  Q18 = h(Q18)
  [Q18, Q27] = cx(Q18, Q27)
  Q18 = h(Q18)
}

Gate 0: [15, ]
Fusing gate 22(0) for rank 0
t 15
Matrix Multiplication (5, 1), mask 1
Gate 1: [15, 27, ]
Fusing gate 6(1) for rank 0
c,t 15,27
Matrix Multiplication (5, 2), mask 17
Gate 2: [15, ]
Fusing gate 22(0) for rank 0
t 15
Matrix Multiplication (5, 1), mask 1
Gate 3: [16, ]
Fusing gate 22(0) for rank 0
t 16
Matrix Multiplication (5, 1), mask 2
Gate 4: [16, 27, ]
Fusing gate 6(1) for rank 0
c,t 16,27
Matrix Multiplication (5, 2), mask 18
Gate 5: [16, ]
Fusing gate 22(0) for rank 0
t 16
Matrix Multiplication (5, 1), mask 2
Gate 6: [17, ]
Fusing gate 22(0) for rank 0
t 17
Matrix Multiplication (5, 1), mask 4
Gate 7: [17, 27, ]
Fusing gate 6(1) for rank 0
c,t 17,27
Matrix Multiplication (5, 2), mask 20
Gate 8: [17, ]
Fusing gate 22(0) for rank 0
t 17
Matrix Multiplication (5, 1), mask 4
Gate 9: [18, ]
Fusing gate 0(0) for rank 0
t 18
Matrix Multiplication (5, 1), mask 8
Gate 10: [18, 27, ]
Fusing gate 6(1) for rank 0
c,t 18,27
Matrix Multiplication (5, 2), mask 24
Gate 11: [18, ]
Fusing gate 0(0) for rank 0
t 18
Matrix Multiplication (5, 1), mask 8
Start fusing gates...
Reset qubit group map
(19, 19) (20, 20) (21, 21) (22, 22) (27, 27) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,]
Fusing Kernel (12 gates): qubits [19, 20, 21, 22, 27], gates fusion, qubits [19, 20, 21, 22, 27], gates CircuitSeq {
  Q19 = h(Q19)
  [Q19, Q27] = cx(Q19, Q27)
  Q19 = h(Q19)
  Q20 = h(Q20)
  [Q20, Q27] = cx(Q20, Q27)
  Q20 = h(Q20)
  Q21 = h(Q21)
  [Q21, Q27] = cx(Q21, Q27)
  Q21 = h(Q21)
  Q22 = h(Q22)
  [Q22, Q27] = cx(Q22, Q27)
  Q22 = h(Q22)
}

Gate 0: [19, ]
Fusing gate 0(0) for rank 0
t 19
Matrix Multiplication (5, 1), mask 1
Gate 1: [19, 27, ]
Fusing gate 6(1) for rank 0
c,t 19,27
Matrix Multiplication (5, 2), mask 17
Gate 2: [19, ]
Fusing gate 0(0) for rank 0
t 19
Matrix Multiplication (5, 1), mask 1
Gate 3: [20, ]
Fusing gate 0(0) for rank 0
t 20
Matrix Multiplication (5, 1), mask 2
Gate 4: [20, 27, ]
Fusing gate 6(1) for rank 0
c,t 20,27
Matrix Multiplication (5, 2), mask 18
Gate 5: [20, ]
Fusing gate 0(0) for rank 0
t 20
Matrix Multiplication (5, 1), mask 2
Gate 6: [21, ]
Fusing gate 0(0) for rank 0
t 21
Matrix Multiplication (5, 1), mask 4
Gate 7: [21, 27, ]
Fusing gate 6(1) for rank 0
c,t 21,27
Matrix Multiplication (5, 2), mask 20
Gate 8: [21, ]
Fusing gate 0(0) for rank 0
t 21
Matrix Multiplication (5, 1), mask 4
Gate 9: [22, ]
Fusing gate 0(0) for rank 0
t 22
Matrix Multiplication (5, 1), mask 8
Gate 10: [22, 27, ]
Fusing gate 6(1) for rank 0
c,t 22,27
Matrix Multiplication (5, 2), mask 24
Gate 11: [22, ]
Fusing gate 0(0) for rank 0
t 22
Matrix Multiplication (5, 1), mask 8
Start fusing gates...
Reset qubit group map
(23, 23) (24, 24) (25, 25) (26, 26) (27, 27) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,]
Fusing Kernel (12 gates): qubits [23, 24, 25, 26, 27], gates fusion, qubits [23, 24, 25, 26, 27], gates CircuitSeq {
  Q23 = h(Q23)
  [Q23, Q27] = cx(Q23, Q27)
  Q23 = h(Q23)
  Q24 = u2(Q24, P0, P0)
  [Q24, Q27] = cx(Q24, Q27)
  Q24 = u2(Q24, P1, P1)
  Q25 = h(Q25)
  [Q25, Q27] = cx(Q25, Q27)
  Q25 = h(Q25)
  Q26 = h(Q26)
  [Q26, Q27] = cx(Q26, Q27)
  Q26 = h(Q26)
}

Gate 0: [23, ]
Fusing gate 0(0) for rank 0
t 23
Matrix Multiplication (5, 1), mask 1
Gate 1: [23, 27, ]
Fusing gate 6(1) for rank 0
c,t 23,27
Matrix Multiplication (5, 2), mask 17
Gate 2: [23, ]
Fusing gate 0(0) for rank 0
t 23
Matrix Multiplication (5, 1), mask 1
Gate 3: [24, ]
Fusing gate 22(0) for rank 0
t 24
Matrix Multiplication (5, 1), mask 2
Gate 4: [24, 27, ]
Fusing gate 6(1) for rank 0
c,t 24,27
Matrix Multiplication (5, 2), mask 18
Gate 5: [24, ]
Fusing gate 22(0) for rank 0
t 24
Matrix Multiplication (5, 1), mask 2
Gate 6: [25, ]
Fusing gate 0(0) for rank 0
t 25
Matrix Multiplication (5, 1), mask 4
Gate 7: [25, 27, ]
Fusing gate 6(1) for rank 0
c,t 25,27
Matrix Multiplication (5, 2), mask 20
Gate 8: [25, ]
Fusing gate 0(0) for rank 0
t 25
Matrix Multiplication (5, 1), mask 4
Gate 9: [26, ]
Fusing gate 0(0) for rank 0
t 26
Matrix Multiplication (5, 1), mask 8
Gate 10: [26, 27, ]
Fusing gate 6(1) for rank 0
c,t 26,27
Matrix Multiplication (5, 2), mask 24
Gate 11: [26, ]
Fusing gate 0(0) for rank 0
t 26
Matrix Multiplication (5, 1), mask 8
Compilation Done! 
Num Shuffles: 0
Num FUSION Kernel: 7
Num SHM Kernel: 0
Start Simulating...
[warmup] size total:4294967296
NCCL comm nRanks: 1, i am 0
I am 0, mask 0, I am sending to 0
hello checking all2all
Init State Vectors!
Finish Simulating! Total: 7 FUSE Kernel, 0 SHM Kernel, 0 Shuffles.
[NCCL Rank 0] Total Simulation Time: 46.03ms
[MPI Rank 0]: Destroyed everthing!
Time Cost: 61391 us
Destroyed the simulator
