Num ranks: 4, myrank: 0
Num ranks: 4, myrank: 2
Num ranks: 4, myrank: 1
Num ranks: 4, myrank: 3
Use cached schedule
Use cached schedule
Compilation Done! 
Num Shuffles: 3
Num FUSION Kernel: 17
Num SHM Kernel: 18
Start Simulating...
Compilation Done! 
Num Shuffles: 3
Num FUSION Kernel: 17
Num SHM Kernel: 18
Start Simulating...
Use cached schedule
Compilation Done! 
Num Shuffles: 3
Num FUSION Kernel: 17
Num SHM Kernel: 18
Start Simulating...
Use cached schedule
Compilation Done! 
Num Shuffles: 3
Num FUSION Kernel: 17
Num SHM Kernel: 18
Start Simulating...
[warmup] size total:268435456
[warmup] size total:268435456
[warmup] size total:268435456
[warmup] size total:268435456
Init State Vectors on 4 devices
Init State Vectors on 4 devices
Init State Vectors on 4 devices
Init State Vectors on 4 devices
[NCCL Rank 0] Shuffle Time: 231.48ms
[NCCL Rank 1] Shuffle Time: 231.50ms
[NCCL Rank 2] Shuffle Time: 231.51ms
[NCCL Rank 8] Shuffle Time: 258.26ms
[NCCL Rank 9] Shuffle Time: 258.55ms
[NCCL Rank 10] Shuffle Time: 258.56ms
[NCCL Rank 11] Shuffle Time: 258.57ms
[NCCL Rank 12] Shuffle Time: 261.03ms
[NCCL Rank 13] Shuffle Time: 261.05ms
[NCCL Rank 14] Shuffle Time: 261.06ms
[NCCL Rank 4] Shuffle Time: 260.13ms
[NCCL Rank 5] Shuffle Time: 260.16ms
[NCCL Rank 6] Shuffle Time: 260.17ms
[NCCL Rank 7] Shuffle Time: 260.18ms
[NCCL Rank 3] Shuffle Time: 233.21ms
[NCCL Rank 15] Shuffle Time: 261.07ms
[NCCL Rank 12] Shuffle Time: 232.99ms
[NCCL Rank 13] Shuffle Time: 229.86ms
[NCCL Rank 14] Shuffle Time: 230.09ms
[NCCL Rank 4] Shuffle Time: 238.98ms
[NCCL Rank 5] Shuffle Time: 235.89ms
[NCCL Rank 6] Shuffle Time: 235.82ms
[NCCL Rank 15] Shuffle Time: 230.01ms
[NCCL Rank 0] Shuffle Time: 241.59ms
[NCCL Rank 1] Shuffle Time: 238.67ms
[NCCL Rank 2] Shuffle Time: 238.60ms
[NCCL Rank 3] Shuffle Time: 235.66ms
[NCCL Rank 8] Shuffle Time: 241.88ms
[NCCL Rank 7] Shuffle Time: 234.11ms
[NCCL Rank 9] Shuffle Time: 238.51ms
[NCCL Rank 10] Shuffle Time: 238.44ms
[NCCL Rank 11] Shuffle Time: 235.34ms
[NCCL Rank 8] Shuffle Time: 248.63ms
[NCCL Rank 9] Shuffle Time: 241.42ms
[NCCL Rank 10] Shuffle Time: 240.87ms
[NCCL Rank 11] Shuffle Time: 232.83ms
[NCCL Rank 0] Shuffle Time: 255.11ms
[NCCL Rank 1] Shuffle Time: 247.77ms
[NCCL Rank 2] Shuffle Time: 247.87ms
[NCCL Rank 12] Shuffle Time: 242.76ms
[NCCL Rank 13] Shuffle Time: 234.59ms
[NCCL Rank 14] Shuffle Time: 234.67ms
[NCCL Rank 4] Shuffle Time: 248.51ms
[NCCL Rank 5] Shuffle Time: 240.57ms
[NCCL Rank 6] Shuffle Time: 240.96ms
[NCCL Rank 3] Shuffle Time: 240.08ms
[NCCL Rank 15] Shuffle Time: 226.94ms
[NCCL Rank 7] Shuffle Time: 233.25ms
Finish Simulating! Total: 17 FUSE Kernel, 18 SHM Kernel, 3 Shuffles.
Finish Simulating! Total: 17 FUSE Kernel, 18 SHM Kernel, 3 Shuffles.
Finish Simulating! Total: 17 FUSE Kernel, 18 SHM Kernel, 3 Shuffles.
Finish Simulating! Total: 17 FUSE Kernel, 18 SHM Kernel, 3 Shuffles.
[NCCL Rank 8] Total Simulation Time: 1368.80ms
[NCCL Rank 9] Total Simulation Time: 1368.87ms
[NCCL Rank 10] Total Simulation Time: 1368.86ms
[NCCL Rank 11] Total Simulation Time: 1368.96ms
[NCCL Rank 12] Total Simulation Time: 1366.94ms
[NCCL Rank 13] Total Simulation Time: 1366.98ms
[NCCL Rank 14] Total Simulation Time: 1366.99ms
[NCCL Rank 15] Total Simulation Time: 1367.00ms
[NCCL Rank 0] Total Simulation Time: 1352.57ms
[NCCL Rank 1] Total Simulation Time: 1352.59ms
[NCCL Rank 2] Total Simulation Time: 1352.60ms
[NCCL Rank 3] Total Simulation Time: 1352.67ms
[MPI Rank 0]: Shuffle 0 cost 231.92ms on average.
[MPI Rank 0]: Shuffle 1 cost 238.63ms on average.
[MPI Rank 0]: Shuffle 2 cost 247.71ms on average.
[NCCL Rank 4] Total Simulation Time: 1371.14ms
[NCCL Rank 5] Total Simulation Time: 1371.14ms
[NCCL Rank 6] Total Simulation Time: 1371.16ms
[NCCL Rank 7] Total Simulation Time: 1371.21ms
[MPI Rank 3]: Destroyed everything!
Time Cost: 1484191 us
Destroyed the simulator
[MPI Rank 1]: Destroyed everything!
Time Cost: 1506056 us
Destroyed the simulator
[MPI Rank 2]: Destroyed everything!
Time Cost: 1513288 us
Destroyed the simulator
[MPI Rank 0]: Destroyed everything!
Time Cost: 1520083 us
Destroyed the simulator
