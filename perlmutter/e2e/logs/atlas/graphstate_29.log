Num ranks: 1, myrank: 0
Computed and cached schedule in 5.424 seconds.
Current Layout0: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 21, 22, 23, 24, 25, 26, 27, 28, 20, Start fusing gates...
Reset qubit group map
(3, 3) (4, 4) (12, 12) (17, 17) (18, 18) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,21,22,23,24,25,26,27,28,20,]
Fusing Kernel (9 gates): qubits [3, 4, 12, 17, 18], gates fusion, qubits [3, 4, 12, 17, 18], gates CircuitSeq {
  Q3 = h(Q3)
  Q4 = h(Q4)
  [Q3, Q4] = cz(Q3, Q4)
  Q12 = h(Q12)
  [Q3, Q12] = cz(Q3, Q12)
  Q17 = h(Q17)
  [Q4, Q17] = cz(Q4, Q17)
  Q18 = h(Q18)
  [Q17, Q18] = cz(Q17, Q18)
}

Gate 0: [3, ]
Fusing gate 0(0) for rank 0
t 3
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 1
t 3
Matrix Multiplication (5, 1), mask 1
Gate 1: [4, ]
Fusing gate 0(0) for rank 0
t 4
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 1
t 4
Matrix Multiplication (5, 1), mask 2
Gate 2: [3, 4, ]
Fusing gate 25(1) for rank 0
c,t 3,4
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 1
c,t 3,4
Matrix Multiplication (5, 2), mask 3
Gate 3: [12, ]
Fusing gate 0(0) for rank 0
t 12
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 1
t 12
Matrix Multiplication (5, 1), mask 4
Gate 4: [3, 12, ]
Fusing gate 25(1) for rank 0
c,t 3,12
Matrix Multiplication (5, 2), mask 5
Fusing gate 25(1) for rank 1
c,t 3,12
Matrix Multiplication (5, 2), mask 5
Gate 5: [17, ]
Fusing gate 0(0) for rank 0
t 17
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 1
t 17
Matrix Multiplication (5, 1), mask 8
Gate 6: [4, 17, ]
Fusing gate 25(1) for rank 0
c,t 4,17
Matrix Multiplication (5, 2), mask 10
Fusing gate 25(1) for rank 1
c,t 4,17
Matrix Multiplication (5, 2), mask 10
Gate 7: [18, ]
Fusing gate 0(0) for rank 0
t 18
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 1
t 18
Matrix Multiplication (5, 1), mask 16
Gate 8: [17, 18, ]
Fusing gate 25(1) for rank 0
c,t 17,18
Matrix Multiplication (5, 2), mask 24
Fusing gate 25(1) for rank 1
c,t 17,18
Matrix Multiplication (5, 2), mask 24
Start fusing gates...
Reset qubit group map
(5, 5) (6, 6) (9, 9) (10, 10) (15, 15) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,21,22,23,24,25,26,27,28,20,]
Fusing Kernel (8 gates): qubits [5, 6, 9, 10, 15], gates fusion, qubits [5, 6, 9, 10, 15], gates CircuitSeq {
  Q5 = h(Q5)
  Q6 = h(Q6)
  [Q5, Q6] = cz(Q5, Q6)
  Q9 = h(Q9)
  Q10 = h(Q10)
  [Q9, Q10] = cz(Q9, Q10)
  Q15 = h(Q15)
  [Q10, Q15] = cz(Q10, Q15)
}

Gate 0: [5, ]
Fusing gate 0(0) for rank 0
t 5
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 1
t 5
Matrix Multiplication (5, 1), mask 1
Gate 1: [6, ]
Fusing gate 0(0) for rank 0
t 6
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 1
t 6
Matrix Multiplication (5, 1), mask 2
Gate 2: [5, 6, ]
Fusing gate 25(1) for rank 0
c,t 5,6
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 1
c,t 5,6
Matrix Multiplication (5, 2), mask 3
Gate 3: [9, ]
Fusing gate 0(0) for rank 0
t 9
Matrix Multiplication (5, 1), mask 4
Fusing gate 0(0) for rank 1
t 9
Matrix Multiplication (5, 1), mask 4
Gate 4: [10, ]
Fusing gate 0(0) for rank 0
t 10
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 1
t 10
Matrix Multiplication (5, 1), mask 8
Gate 5: [9, 10, ]
Fusing gate 25(1) for rank 0
c,t 9,10
Matrix Multiplication (5, 2), mask 12
Fusing gate 25(1) for rank 1
c,t 9,10
Matrix Multiplication (5, 2), mask 12
Gate 6: [15, ]
Fusing gate 0(0) for rank 0
t 15
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 1
t 15
Matrix Multiplication (5, 1), mask 16
Gate 7: [10, 15, ]
Fusing gate 25(1) for rank 0
c,t 10,15
Matrix Multiplication (5, 2), mask 24
Fusing gate 25(1) for rank 1
c,t 10,15
Matrix Multiplication (5, 2), mask 24
SHM Kernel Physical (17): [ 0,1,2,7,8,11,16,19,21]
shared_memory, qubits [0, 1, 2, 7, 8, 11, 16, 19, 22], gates CircuitSeq {
  Q0 = h(Q0)
  Q1 = h(Q1)
  [Q0, Q1] = cz(Q0, Q1)
  Q2 = h(Q2)
  [Q0, Q2] = cz(Q0, Q2)
  Q7 = h(Q7)
  Q8 = h(Q8)
  [Q7, Q8] = cz(Q7, Q8)
  Q11 = h(Q11)
  [Q8, Q11] = cz(Q8, Q11)
  Q16 = h(Q16)
  [Q11, Q16] = cz(Q11, Q16)
  Q19 = h(Q19)
  [Q18, Q19] = cz(Q18, Q19)
  Q22 = h(Q22)
  [Q6, Q22] = cz(Q6, Q22)
  [Q12, Q22] = cz(Q12, Q22)
}

Start fusing gates...
Reset qubit group map
(13, 13) (14, 14) (19, 19) (20, 21) (22, 23) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,21,22,23,24,25,26,27,28,20,]
Fusing Kernel (8 gates): qubits [13, 14, 19, 21, 23], gates fusion, qubits [13, 14, 19, 21, 23], gates CircuitSeq {
  Q13 = h(Q13)
  Q14 = h(Q14)
  [Q13, Q14] = cz(Q13, Q14)
  Q21 = h(Q21)
  [Q13, Q21] = cz(Q13, Q21)
  Q23 = h(Q23)
  [Q19, Q23] = cz(Q19, Q23)
  [Q21, Q23] = cz(Q21, Q23)
}

Gate 0: [13, ]
Fusing gate 0(0) for rank 0
t 13
Matrix Multiplication (5, 1), mask 1
Fusing gate 0(0) for rank 1
t 13
Matrix Multiplication (5, 1), mask 1
Gate 1: [14, ]
Fusing gate 0(0) for rank 0
t 14
Matrix Multiplication (5, 1), mask 2
Fusing gate 0(0) for rank 1
t 14
Matrix Multiplication (5, 1), mask 2
Gate 2: [13, 14, ]
Fusing gate 25(1) for rank 0
c,t 13,14
Matrix Multiplication (5, 2), mask 3
Fusing gate 25(1) for rank 1
c,t 13,14
Matrix Multiplication (5, 2), mask 3
Gate 3: [21, ]
Fusing gate 0(0) for rank 0
t 21
Matrix Multiplication (5, 1), mask 8
Fusing gate 0(0) for rank 1
t 21
Matrix Multiplication (5, 1), mask 8
Gate 4: [13, 21, ]
Fusing gate 25(1) for rank 0
c,t 13,21
Matrix Multiplication (5, 2), mask 9
Fusing gate 25(1) for rank 1
c,t 13,21
Matrix Multiplication (5, 2), mask 9
Gate 5: [23, ]
Fusing gate 0(0) for rank 0
t 23
Matrix Multiplication (5, 1), mask 16
Fusing gate 0(0) for rank 1
t 23
Matrix Multiplication (5, 1), mask 16
Gate 6: [19, 23, ]
Fusing gate 25(1) for rank 0
c,t 19,23
Matrix Multiplication (5, 2), mask 20
Fusing gate 25(1) for rank 1
c,t 19,23
Matrix Multiplication (5, 2), mask 20
Gate 7: [21, 23, ]
Fusing gate 25(1) for rank 0
c,t 21,23
Matrix Multiplication (5, 2), mask 24
Fusing gate 25(1) for rank 1
c,t 21,23
Matrix Multiplication (5, 2), mask 24
SHM Kernel Physical (13): [ 23,24,25,26,27]
shared_memory, qubits [24, 25, 26, 27, 28], gates CircuitSeq {
  Q24 = h(Q24)
  [Q2, Q24] = cz(Q2, Q24)
  [Q16, Q24] = cz(Q16, Q24)
  Q25 = h(Q25)
  [Q5, Q25] = cz(Q5, Q25)
  Q26 = h(Q26)
  [Q25, Q26] = cz(Q25, Q26)
  Q27 = h(Q27)
  [Q9, Q27] = cz(Q9, Q27)
  [Q14, Q27] = cz(Q14, Q27)
  Q28 = h(Q28)
  [Q7, Q28] = cz(Q7, Q28)
  [Q26, Q28] = cz(Q26, Q28)
}

Current Layout0: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 28, 12, 13, 14, 15, 16, 17, 18, 19, 21, 22, 23, 24, 25, 26, 27, 20, 11, Start fusing gates...
Reset qubit group map
(1, 1) (15, 15) (27, 20) current Layout: [0,1,2,3,4,5,6,7,8,9,10,28,12,13,14,15,16,17,18,19,21,22,23,24,25,26,27,20,11,]
Fusing Kernel (3 gates): qubits [1, 15, 20], gates fusion, qubits [1, 15, 20], gates CircuitSeq {
  Q20 = h(Q20)
  [Q1, Q20] = cz(Q1, Q20)
  [Q15, Q20] = cz(Q15, Q20)
}

Gate 0: [20, ]
Fusing gate 0(0) for rank 0
t 20
Matrix Multiplication (3, 1), mask 4
Fusing gate 0(0) for rank 1
t 20
Matrix Multiplication (3, 1), mask 4
Gate 1: [1, 20, ]
Fusing gate 25(1) for rank 0
c,t 1,20
Matrix Multiplication (3, 2), mask 5
Fusing gate 25(1) for rank 1
c,t 1,20
Matrix Multiplication (3, 2), mask 5
Gate 2: [15, 20, ]
Fusing gate 25(1) for rank 0
c,t 15,20
Matrix Multiplication (3, 2), mask 6
Fusing gate 25(1) for rank 1
c,t 15,20
Matrix Multiplication (3, 2), mask 6
Compilation Done! 
Num Shuffles: 1
Num FUSION Kernel: 4
Num SHM Kernel: 2
Start Simulating...
[warmup] size total:2147483648
NCCL comm nRanks: 2, i am 0
I am 0, mask 1, I am sending to 0
I am 0, mask 1, I am sending to 1
NCCL comm nRanks: 2, i am 1
I am 1, mask 1, I am sending to 0
I am 1, mask 1, I am sending to 1
hello checking all2all
Init State Vectors!
Using NCCL for cross-node shuffle
My physical id:0, 1
NCCL comm nRanks: 2, i am 0
I am 0, mask 1, I am sending to 0
I am 0, mask 1, I am sending to 1
My physical id:1, 1
NCCL comm nRanks: 2, i am 1
I am 1, mask 1, I am sending to 0
I am 1, mask 1, I am sending to 1
[NCCL Rank 0] Shuffle Time: 36.24ms
[NCCL Rank 1] Shuffle Time: 36.28ms
Finish Simulating! Total: 4 FUSE Kernel, 2 SHM Kernel, 1 Shuffles.
[NCCL Rank 0] Total Simulation Time: 89.94ms
[NCCL Rank 1] Total Simulation Time: 89.95ms
[MPI Rank 0]: Shuffle 0 cost 36.26ms on average.
Solving ILP for num_qubits=29, num_local_qubits=28, num_global_qubits=0, num_iterations=1...
Available solvers: ['PULP_CBC_CMD', 'HiGHS_CMD']
Running HiGHS 1.5.0 [date: 2023-11-09, git hash: 8a114449a]
Copyright (c) 2022 HiGHS under MIT licence terms
Number of BV entries in BOUNDS section is 174
MIP  71a82593e8b4420487984766561ea816-pulp has 350 rows; 175 cols; 667 nonzeros; 174 integer variables
Presolving model
204 rows, 29 cols, 58 nonzeros
Presolve: Infeasible

Solving report
  Status            Infeasible
  Primal bound      inf
  Dual bound        -inf
  Gap               inf
  Solution status   -
  Timing            0.00 (total)
                    0.00 (presolve)
                    0.00 (postsolve)
  Nodes             0
  LP iterations     0 (total)
                    0 (strong br.)
                    0 (separation)
                    0 (heuristics)
Writing the solution to /tmp/71a82593e8b4420487984766561ea816-pulp.sol
Solving ILP for num_qubits=29, num_local_qubits=28, num_global_qubits=0, num_iterations=2...
Available solvers: ['PULP_CBC_CMD', 'HiGHS_CMD']
Running HiGHS 1.5.0 [date: 2023-11-09, git hash: 8a114449a]
Copyright (c) 2022 HiGHS under MIT licence terms
Number of BV entries in BOUNDS section is 348
MIP  843bf81336fb4b10a8515bb97cf8e2ad-pulp has 584 rows; 348 cols; 1276 nonzeros; 348 integer variables
Presolving model
379 rows, 145 cols, 493 nonzeros
60 rows, 87 cols, 203 nonzeros
60 rows, 87 cols, 203 nonzeros
Objective function is integral with scale 1

Solving MIP model with:
   60 rows
   87 cols (87 binary, 0 integer, 0 implied int., 0 continuous)
   203 nonzeros

        Nodes      |    B&B Tree     |            Objective Bounds              |  Dynamic Constraints |       Work      
     Proc. InQueue |  Leaves   Expl. | BestBound       BestSol              Gap |   Cuts   InLp Confl. | LpIters     Time

         0       0         0   0.00%   0               inf                  inf        0      0      0         0     0.0s

Solving report
  Status            Optimal
  Primal bound      1
  Dual bound        1
  Gap               0% (tolerance: 0.01%)
  Solution status   feasible
                    1 (objective)
                    0 (bound viol.)
                    0 (int. viol.)
                    0 (row viol.)
  Timing            0.00 (total)
                    0.00 (presolve)
                    0.00 (postsolve)
  Nodes             1
  LP iterations     10 (total)
                    0 (strong br.)
                    0 (separation)
                    0 (heuristics)
Writing the solution to /tmp/843bf81336fb4b10a8515bb97cf8e2ad-pulp.sol
[MPI Rank 0]: Destroyed everthing!
Time Cost: 123953 us
Destroyed the simulator
