Num ranks: 1, myrank: 0
Computed and cached schedule in 0.27 seconds.
Current Layout0: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, Start fusing gates...
Reset qubit group map
(2, 2) (3, 3) (6, 6) (7, 7) (13, 13) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,]
Fusing Kernel (9 gates): qubits [2, 3, 6, 7, 13], gates fusion, qubits [2, 3, 6, 7, 13], gates CircuitSeq {
  Q2 = h(Q2)
  Q3 = h(Q3)
  [Q2, Q3] = cz(Q2, Q3)
  Q7 = h(Q7)
  [Q3, Q7] = cz(Q3, Q7)
  Q6 = h(Q6)
  [Q6, Q7] = cz(Q6, Q7)
  Q13 = h(Q13)
  [Q6, Q13] = cz(Q6, Q13)
}

Gate 0: [2, ]
Fusing gate 0(0) for rank 0
t 2
Matrix Multiplication (5, 1), mask 1
Gate 1: [3, ]
Fusing gate 0(0) for rank 0
t 3
Matrix Multiplication (5, 1), mask 2
Gate 2: [2, 3, ]
Fusing gate 25(1) for rank 0
c,t 2,3
Matrix Multiplication (5, 2), mask 3
Gate 3: [7, ]
Fusing gate 0(0) for rank 0
t 7
Matrix Multiplication (5, 1), mask 8
Gate 4: [3, 7, ]
Fusing gate 25(1) for rank 0
c,t 3,7
Matrix Multiplication (5, 2), mask 10
Gate 5: [6, ]
Fusing gate 0(0) for rank 0
t 6
Matrix Multiplication (5, 1), mask 4
Gate 6: [6, 7, ]
Fusing gate 25(1) for rank 0
c,t 6,7
Matrix Multiplication (5, 2), mask 12
Gate 7: [13, ]
Fusing gate 0(0) for rank 0
t 13
Matrix Multiplication (5, 1), mask 16
Gate 8: [6, 13, ]
Fusing gate 25(1) for rank 0
c,t 6,13
Matrix Multiplication (5, 2), mask 20
Start fusing gates...
Reset qubit group map
(0, 0) (1, 1) (10, 10) (11, 11) (16, 16) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,]
Fusing Kernel (9 gates): qubits [0, 1, 10, 11, 16], gates fusion, qubits [0, 1, 10, 11, 16], gates CircuitSeq {
  Q0 = h(Q0)
  Q1 = h(Q1)
  [Q0, Q1] = cz(Q0, Q1)
  Q11 = h(Q11)
  [Q0, Q11] = cz(Q0, Q11)
  Q10 = h(Q10)
  [Q10, Q11] = cz(Q10, Q11)
  Q16 = h(Q16)
  [Q10, Q16] = cz(Q10, Q16)
}

Gate 0: [0, ]
Fusing gate 0(0) for rank 0
t 0
Matrix Multiplication (5, 1), mask 1
Gate 1: [1, ]
Fusing gate 0(0) for rank 0
t 1
Matrix Multiplication (5, 1), mask 2
Gate 2: [0, 1, ]
Fusing gate 25(1) for rank 0
c,t 0,1
Matrix Multiplication (5, 2), mask 3
Gate 3: [11, ]
Fusing gate 0(0) for rank 0
t 11
Matrix Multiplication (5, 1), mask 8
Gate 4: [0, 11, ]
Fusing gate 25(1) for rank 0
c,t 0,11
Matrix Multiplication (5, 2), mask 9
Gate 5: [10, ]
Fusing gate 0(0) for rank 0
t 10
Matrix Multiplication (5, 1), mask 4
Gate 6: [10, 11, ]
Fusing gate 25(1) for rank 0
c,t 10,11
Matrix Multiplication (5, 2), mask 12
Gate 7: [16, ]
Fusing gate 0(0) for rank 0
t 16
Matrix Multiplication (5, 1), mask 16
Gate 8: [10, 16, ]
Fusing gate 25(1) for rank 0
c,t 10,16
Matrix Multiplication (5, 2), mask 20
SHM Kernel Physical (13): [ 4,5,8,9,14,15,18]
shared_memory, qubits [4, 5, 8, 9, 14, 15, 18], gates CircuitSeq {
  Q4 = h(Q4)
  Q5 = h(Q5)
  [Q4, Q5] = cz(Q4, Q5)
  Q8 = h(Q8)
  Q9 = h(Q9)
  [Q8, Q9] = cz(Q8, Q9)
  Q15 = h(Q15)
  [Q4, Q15] = cz(Q4, Q15)
  Q14 = h(Q14)
  [Q14, Q15] = cz(Q14, Q15)
  Q18 = h(Q18)
  [Q1, Q18] = cz(Q1, Q18)
  [Q5, Q18] = cz(Q5, Q18)
}

Start fusing gates...
Reset qubit group map
(2, 2) (21, 21) (22, 22) (23, 23) (26, 26) current Layout: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,]
Fusing Kernel (8 gates): qubits [2, 21, 22, 23, 26], gates fusion, qubits [2, 21, 22, 23, 26], gates CircuitSeq {
  Q21 = h(Q21)
  Q22 = h(Q22)
  [Q21, Q22] = cz(Q21, Q22)
  Q23 = h(Q23)
  [Q2, Q23] = cz(Q2, Q23)
  [Q21, Q23] = cz(Q21, Q23)
  Q26 = h(Q26)
  [Q22, Q26] = cz(Q22, Q26)
}

Gate 0: [21, ]
Fusing gate 0(0) for rank 0
t 21
Matrix Multiplication (5, 1), mask 2
Gate 1: [22, ]
Fusing gate 0(0) for rank 0
t 22
Matrix Multiplication (5, 1), mask 4
Gate 2: [21, 22, ]
Fusing gate 25(1) for rank 0
c,t 21,22
Matrix Multiplication (5, 2), mask 6
Gate 3: [23, ]
Fusing gate 0(0) for rank 0
t 23
Matrix Multiplication (5, 1), mask 8
Gate 4: [2, 23, ]
Fusing gate 25(1) for rank 0
c,t 2,23
Matrix Multiplication (5, 2), mask 9
Gate 5: [21, 23, ]
Fusing gate 25(1) for rank 0
c,t 21,23
Matrix Multiplication (5, 2), mask 10
Gate 6: [26, ]
Fusing gate 0(0) for rank 0
t 26
Matrix Multiplication (5, 1), mask 16
Gate 7: [22, 26, ]
Fusing gate 25(1) for rank 0
c,t 22,26
Matrix Multiplication (5, 2), mask 20
SHM Kernel Physical (17): [ 12,17,19,20,24,25,27]
shared_memory, qubits [12, 17, 19, 20, 24, 25, 27], gates CircuitSeq {
  Q12 = h(Q12)
  [Q12, Q13] = cz(Q12, Q13)
  Q17 = h(Q17)
  [Q16, Q17] = cz(Q16, Q17)
  Q19 = h(Q19)
  [Q12, Q19] = cz(Q12, Q19)
  Q20 = h(Q20)
  [Q8, Q20] = cz(Q8, Q20)
  [Q19, Q20] = cz(Q19, Q20)
  Q24 = h(Q24)
  [Q9, Q24] = cz(Q9, Q24)
  Q25 = h(Q25)
  [Q17, Q25] = cz(Q17, Q25)
  [Q24, Q25] = cz(Q24, Q25)
  Q27 = h(Q27)
  [Q14, Q27] = cz(Q14, Q27)
  [Q26, Q27] = cz(Q26, Q27)
}

Compilation Done! 
Num Shuffles: 0
Num FUSION Kernel: 3
Num SHM Kernel: 2
Start Simulating...
[warmup] size total:4294967296
NCCL comm nRanks: 1, i am 0
I am 0, mask 0, I am sending to 0
hello checking all2all
Init State Vectors!
Finish Simulating! Total: 3 FUSE Kernel, 2 SHM Kernel, 0 Shuffles.
[NCCL Rank 0] Total Simulation Time: 37.01ms
[MPI Rank 0]: Destroyed everthing!
Time Cost: 51780 us
Destroyed the simulator
