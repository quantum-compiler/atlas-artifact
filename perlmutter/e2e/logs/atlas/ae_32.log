Num ranks: 4, myrank: 2
Num ranks: 4, myrank: 3
Num ranks: 4, myrank: 1
Num ranks: 4, myrank: 0
Use cached schedule
Use cached schedule
Use cached schedule
Use cached schedule
Compilation Done! 
Num Shuffles: 2
Num FUSION Kernel: 12
Num SHM Kernel: 4
Start Simulating...
Compilation Done! 
Num Shuffles: 2
Num FUSION Kernel: 12
Num SHM Kernel: 4
Start Simulating...
Compilation Done! 
Num Shuffles: 2
Num FUSION Kernel: 12
Num SHM Kernel: 4
Start Simulating...
Compilation Done! 
Num Shuffles: 2
Num FUSION Kernel: 12
Num SHM Kernel: 4
Start Simulating...
[warmup] size total:268435456
[warmup] size total:268435456
[warmup] size total:268435456
[warmup] size total:268435456
Init State Vectors on 4 devices
Init State Vectors on 4 devices
Init State Vectors on 4 devices
Init State Vectors on 4 devices
[NCCL Rank 12] Shuffle Time: 232.28ms
[NCCL Rank 13] Shuffle Time: 232.36ms
[NCCL Rank 14] Shuffle Time: 232.37ms
[NCCL Rank 15] Shuffle Time: 232.38ms
[NCCL Rank 4] Shuffle Time: 234.43ms
[NCCL Rank 5] Shuffle Time: 234.44ms
[NCCL Rank 6] Shuffle Time: 234.46ms
[NCCL Rank 0] Shuffle Time: 234.63ms
[NCCL Rank 1] Shuffle Time: 234.64ms
[NCCL Rank 8] Shuffle Time: 233.89ms
[NCCL Rank 9] Shuffle Time: 233.91ms
[NCCL Rank 10] Shuffle Time: 233.92ms
[NCCL Rank 11] Shuffle Time: 233.93ms
[NCCL Rank 7] Shuffle Time: 234.47ms
[NCCL Rank 2] Shuffle Time: 234.88ms
[NCCL Rank 3] Shuffle Time: 234.89ms
[NCCL Rank 12] Shuffle Time: 232.10ms
[NCCL Rank 13] Shuffle Time: 228.47ms
[NCCL Rank 14] Shuffle Time: 228.34ms
[NCCL Rank 4] Shuffle Time: 239.48ms
[NCCL Rank 5] Shuffle Time: 235.44ms
[NCCL Rank 15] Shuffle Time: 228.46ms
[NCCL Rank 6] Shuffle Time: 233.30ms
[NCCL Rank 8] Shuffle Time: 241.60ms
[NCCL Rank 9] Shuffle Time: 237.62ms
[NCCL Rank 10] Shuffle Time: 234.21ms
[NCCL Rank 11] Shuffle Time: 233.72ms
[NCCL Rank 0] Shuffle Time: 240.60ms
[NCCL Rank 1] Shuffle Time: 236.58ms
[NCCL Rank 7] Shuffle Time: 233.55ms
[NCCL Rank 2] Shuffle Time: 233.40ms
[NCCL Rank 3] Shuffle Time: 232.91ms
Finish Simulating! Total: 12 FUSE Kernel, 4 SHM Kernel, 2 Shuffles.
Finish Simulating! Total: 12 FUSE Kernel, 4 SHM Kernel, 2 Shuffles.
Finish Simulating! Total: 12 FUSE Kernel, 4 SHM Kernel, 2 Shuffles.
Finish Simulating! Total: 12 FUSE Kernel, 4 SHM Kernel, 2 Shuffles.
[NCCL Rank 12] Total Simulation Time: 722.26ms
[NCCL Rank 8] Total Simulation Time: 721.42ms
[NCCL Rank 13] Total Simulation Time: 722.35ms
[NCCL Rank 9] Total Simulation Time: 721.50ms
[NCCL Rank 14] Total Simulation Time: 722.46ms
[NCCL Rank 4] Total Simulation Time: 723.06ms
[NCCL Rank 10] Total Simulation Time: 721.62ms
[NCCL Rank 11] Total Simulation Time: 721.72ms
[NCCL Rank 15] Total Simulation Time: 722.55ms
[NCCL Rank 5] Total Simulation Time: 723.10ms
[NCCL Rank 6] Total Simulation Time: 723.23ms
[NCCL Rank 7] Total Simulation Time: 723.26ms
[NCCL Rank 0] Total Simulation Time: 727.12ms
[NCCL Rank 1] Total Simulation Time: 727.14ms
[NCCL Rank 2] Total Simulation Time: 727.32ms
[NCCL Rank 3] Total Simulation Time: 727.41ms
[MPI Rank 0]: Shuffle 0 cost 234.76ms on average.
[MPI Rank 0]: Shuffle 1 cost 235.87ms on average.
[MPI Rank 3]: Destroyed everything!
Time Cost: 841202 us
Destroyed the simulator
[MPI Rank 0]: Destroyed everything!
Time Cost: 849619 us
Destroyed the simulator
[MPI Rank 2]: Destroyed everything!
Time Cost: 865544 us
Destroyed the simulator
[MPI Rank 1]: Destroyed everything!
Time Cost: 894374 us
Destroyed the simulator
