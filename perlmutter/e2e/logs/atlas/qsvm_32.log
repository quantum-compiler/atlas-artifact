Num ranks: 4, myrank: 2
Num ranks: 4, myrank: 1
Num ranks: 4, myrank: 3
Num ranks: 4, myrank: 0
Use cached schedule
Use cached schedule
Compilation Done! 
Num Shuffles: 2
Num FUSION Kernel: 16
Num SHM Kernel: 0
Start Simulating...
Compilation Done! 
Num Shuffles: 2
Num FUSION Kernel: 16
Num SHM Kernel: 0
Start Simulating...
Use cached schedule
Compilation Done! 
Num Shuffles: 2
Num FUSION Kernel: 16
Num SHM Kernel: 0
Start Simulating...
Use cached schedule
Compilation Done! 
Num Shuffles: 2
Num FUSION Kernel: 16
Num SHM Kernel: 0
Start Simulating...
[warmup] size total:268435456
[warmup] size total:268435456
[warmup] size total:268435456
[warmup] size total:268435456
Init State Vectors on 4 devices
Init State Vectors on 4 devices
Init State Vectors on 4 devices
Init State Vectors on 4 devices
[NCCL Rank 4] Shuffle Time: 233.57ms
[NCCL Rank 5] Shuffle Time: 233.59ms
[NCCL Rank 6] Shuffle Time: 233.59ms
[NCCL Rank 8] Shuffle Time: 234.16ms
[NCCL Rank 7] Shuffle Time: 233.63ms
[NCCL Rank 12] Shuffle Time: 233.16ms
[NCCL Rank 0] Shuffle Time: 234.82ms
[NCCL Rank 1] Shuffle Time: 234.84ms
[NCCL Rank 9] Shuffle Time: 234.51ms
[NCCL Rank 10] Shuffle Time: 234.52ms
[NCCL Rank 11] Shuffle Time: 234.52ms
[NCCL Rank 2] Shuffle Time: 234.86ms
[NCCL Rank 13] Shuffle Time: 234.12ms
[NCCL Rank 14] Shuffle Time: 234.13ms
[NCCL Rank 15] Shuffle Time: 234.14ms
[NCCL Rank 3] Shuffle Time: 234.87ms
[NCCL Rank 4] Shuffle Time: 238.31ms
[NCCL Rank 5] Shuffle Time: 238.14ms
[NCCL Rank 12] Shuffle Time: 236.86ms
[NCCL Rank 8] Shuffle Time: 237.53ms
[NCCL Rank 13] Shuffle Time: 236.83ms
[NCCL Rank 0] Shuffle Time: 236.69ms
[NCCL Rank 9] Shuffle Time: 237.43ms
[NCCL Rank 6] Shuffle Time: 239.09ms
[NCCL Rank 7] Shuffle Time: 238.92ms
[NCCL Rank 14] Shuffle Time: 236.81ms
[NCCL Rank 1] Shuffle Time: 236.60ms
[NCCL Rank 10] Shuffle Time: 237.28ms
[NCCL Rank 15] Shuffle Time: 236.76ms
[NCCL Rank 2] Shuffle Time: 236.51ms
[NCCL Rank 11] Shuffle Time: 237.44ms
[NCCL Rank 3] Shuffle Time: 236.44ms
Finish Simulating! Total: 16 FUSE Kernel, 0 SHM Kernel, 2 Shuffles.
Finish Simulating! Total: 16 FUSE Kernel, 0 SHM Kernel, 2 Shuffles.
Finish Simulating! Total: 16 FUSE Kernel, 0 SHM Kernel, 2 Shuffles.
Finish Simulating! Total: 16 FUSE Kernel, 0 SHM Kernel, 2 Shuffles.
[NCCL Rank 12] Total Simulation Time: 639.21ms
[NCCL Rank 13] Total Simulation Time: 639.22ms
[NCCL Rank 14] Total Simulation Time: 639.23ms
[NCCL Rank 15] Total Simulation Time: 639.25ms
[NCCL Rank 8] Total Simulation Time: 639.86ms
[NCCL Rank 9] Total Simulation Time: 639.88ms
[NCCL Rank 10] Total Simulation Time: 639.89ms
[NCCL Rank 11] Total Simulation Time: 639.90ms
[NCCL Rank 0] Total Simulation Time: 642.97ms
[NCCL Rank 1] Total Simulation Time: 643.00ms
[NCCL Rank 2] Total Simulation Time: 643.02ms
[NCCL Rank 3] Total Simulation Time: 643.03ms
[MPI Rank 0]: Shuffle 0 cost 234.85ms on average.
[MPI Rank 0]: Shuffle 1 cost 236.56ms on average.
[NCCL Rank 4] Total Simulation Time: 649.26ms
[NCCL Rank 5] Total Simulation Time: 649.27ms
[NCCL Rank 6] Total Simulation Time: 649.28ms
[NCCL Rank 7] Total Simulation Time: 649.31ms
[MPI Rank 3]: Destroyed everything!
Time Cost: 758828 us
Destroyed the simulator
[MPI Rank 0]: Destroyed everything!
Time Cost: 770213 us
Destroyed the simulator
[MPI Rank 2]: Destroyed everything!
Time Cost: 784395 us
Destroyed the simulator
[MPI Rank 1]: Destroyed everything!
Time Cost: 820848 us
Destroyed the simulator
