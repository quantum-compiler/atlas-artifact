Num ranks: 2, myrank: 0
Num ranks: 2, myrank: 1
Use cached schedule
Use cached schedule
Compilation Done! 
Num Shuffles: 1
Num FUSION Kernel: 2
Num SHM Kernel: 3
Start Simulating...
Compilation Done! 
Num Shuffles: 1
Num FUSION Kernel: 2
Num SHM Kernel: 3
Start Simulating...
[warmup] size total:536870912
[warmup] size total:536870912
Init State Vectors on 4 devices
Init State Vectors on 4 devices
[NCCL Rank 0] Shuffle Time: 157.27ms
[NCCL Rank 1] Shuffle Time: 158.14ms
[NCCL Rank 2] Shuffle Time: 158.15ms
[NCCL Rank 3] Shuffle Time: 158.16ms
[NCCL Rank 4] Shuffle Time: 156.07ms
[NCCL Rank 5] Shuffle Time: 156.10ms
[NCCL Rank 6] Shuffle Time: 156.11ms
[NCCL Rank 7] Shuffle Time: 156.12ms
Finish Simulating! Total: 2 FUSE Kernel, 3 SHM Kernel, 1 Shuffles.
Finish Simulating! Total: 2 FUSE Kernel, 3 SHM Kernel, 1 Shuffles.
[NCCL Rank 0] Total Simulation Time: 241.94ms
[NCCL Rank 1] Total Simulation Time: 244.20ms
[NCCL Rank 4] Total Simulation Time: 244.01ms
[NCCL Rank 5] Total Simulation Time: 246.10ms
[NCCL Rank 2] Total Simulation Time: 248.32ms
[NCCL Rank 3] Total Simulation Time: 248.50ms
[MPI Rank 0]: Shuffle 0 cost 157.93ms on average.
[NCCL Rank 6] Total Simulation Time: 250.38ms
[NCCL Rank 7] Total Simulation Time: 250.57ms
[MPI Rank 1]: Destroyed everything!
Time Cost: 376937 us
Destroyed the simulator
[MPI Rank 0]: Destroyed everything!
Time Cost: 390012 us
Destroyed the simulator
