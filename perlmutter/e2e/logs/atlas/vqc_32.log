Num ranks: 4, myrank: 2
Num ranks: 4, myrank: 1
Num ranks: 4, myrank: 3
Num ranks: 4, myrank: 0
Use cached schedule
Use cached schedule
Use cached schedule
Compilation Done! 
Num Shuffles: 4
Num FUSION Kernel: 29
Num SHM Kernel: 7
Start Simulating...
Compilation Done! 
Num Shuffles: 4
Num FUSION Kernel: 29
Num SHM Kernel: 7
Start Simulating...
Compilation Done! 
Num Shuffles: 4
Num FUSION Kernel: 29
Num SHM Kernel: 7
Start Simulating...
Use cached schedule
Compilation Done! 
Num Shuffles: 4
Num FUSION Kernel: 29
Num SHM Kernel: 7
Start Simulating...
[warmup] size total:268435456
[warmup] size total:268435456
[warmup] size total:268435456
[warmup] size total:268435456
Init State Vectors on 4 devices
Init State Vectors on 4 devices
Init State Vectors on 4 devices
Init State Vectors on 4 devices
[NCCL Rank 12] Shuffle Time: 248.63ms
[NCCL Rank 13] Shuffle Time: 248.65ms
[NCCL Rank 14] Shuffle Time: 248.66ms
[NCCL Rank 0] Shuffle Time: 247.27ms
[NCCL Rank 1] Shuffle Time: 247.29ms
[NCCL Rank 2] Shuffle Time: 247.30ms
[NCCL Rank 3] Shuffle Time: 247.31ms
[NCCL Rank 15] Shuffle Time: 248.67ms
[NCCL Rank 8] Shuffle Time: 237.25ms
[NCCL Rank 9] Shuffle Time: 237.27ms
[NCCL Rank 10] Shuffle Time: 237.28ms
[NCCL Rank 11] Shuffle Time: 237.28ms
[NCCL Rank 4] Shuffle Time: 233.75ms
[NCCL Rank 5] Shuffle Time: 233.88ms
[NCCL Rank 6] Shuffle Time: 233.89ms
[NCCL Rank 7] Shuffle Time: 233.90ms
[NCCL Rank 12] Shuffle Time: 230.26ms
[NCCL Rank 4] Shuffle Time: 240.84ms
[NCCL Rank 5] Shuffle Time: 240.08ms
[NCCL Rank 6] Shuffle Time: 240.10ms
[NCCL Rank 7] Shuffle Time: 239.20ms
[NCCL Rank 13] Shuffle Time: 230.77ms
[NCCL Rank 14] Shuffle Time: 230.84ms
[NCCL Rank 8] Shuffle Time: 240.89ms
[NCCL Rank 0] Shuffle Time: 241.32ms
[NCCL Rank 1] Shuffle Time: 240.59ms
[NCCL Rank 2] Shuffle Time: 240.62ms
[NCCL Rank 3] Shuffle Time: 239.72ms
[NCCL Rank 15] Shuffle Time: 230.36ms
[NCCL Rank 9] Shuffle Time: 240.30ms
[NCCL Rank 10] Shuffle Time: 240.34ms
[NCCL Rank 11] Shuffle Time: 239.70ms
[NCCL Rank 12] Shuffle Time: 231.29ms
[NCCL Rank 13] Shuffle Time: 228.87ms
[NCCL Rank 14] Shuffle Time: 229.07ms
[NCCL Rank 0] Shuffle Time: 236.03ms
[NCCL Rank 1] Shuffle Time: 233.49ms
[NCCL Rank 2] Shuffle Time: 233.46ms
[NCCL Rank 3] Shuffle Time: 231.10ms
[NCCL Rank 4] Shuffle Time: 235.78ms
[NCCL Rank 5] Shuffle Time: 233.24ms
[NCCL Rank 6] Shuffle Time: 233.33ms
[NCCL Rank 15] Shuffle Time: 228.35ms
[NCCL Rank 8] Shuffle Time: 236.56ms
[NCCL Rank 9] Shuffle Time: 234.06ms
[NCCL Rank 10] Shuffle Time: 234.00ms
[NCCL Rank 11] Shuffle Time: 231.15ms
[NCCL Rank 7] Shuffle Time: 231.10ms
[NCCL Rank 12] Shuffle Time: 233.91ms
[NCCL Rank 13] Shuffle Time: 230.87ms
[NCCL Rank 14] Shuffle Time: 231.38ms
[NCCL Rank 0] Shuffle Time: 238.63ms
[NCCL Rank 1] Shuffle Time: 236.16ms
[NCCL Rank 2] Shuffle Time: 236.19ms
[NCCL Rank 3] Shuffle Time: 233.57ms
[NCCL Rank 15] Shuffle Time: 229.22ms
[NCCL Rank 8] Shuffle Time: 237.71ms
[NCCL Rank 4] Shuffle Time: 237.35ms
[NCCL Rank 5] Shuffle Time: 234.72ms
[NCCL Rank 6] Shuffle Time: 234.81ms
[NCCL Rank 9] Shuffle Time: 235.10ms
[NCCL Rank 7] Shuffle Time: 231.99ms
[NCCL Rank 10] Shuffle Time: 235.39ms
[NCCL Rank 11] Shuffle Time: 232.38ms
Finish Simulating! Total: 29 FUSE Kernel, 7 SHM Kernel, 4 Shuffles.
Finish Simulating! Total: 29 FUSE Kernel, 7 SHM Kernel, 4 Shuffles.
Finish Simulating! Total: 29 FUSE Kernel, 7 SHM Kernel, 4 Shuffles.
Finish Simulating! Total: 29 FUSE Kernel, 7 SHM Kernel, 4 Shuffles.
[NCCL Rank 0] Total Simulation Time: 1645.48ms
[NCCL Rank 4] Total Simulation Time: 1645.41ms
[NCCL Rank 8] Total Simulation Time: 1646.38ms
[NCCL Rank 1] Total Simulation Time: 1647.94ms
[NCCL Rank 2] Total Simulation Time: 1648.12ms
[NCCL Rank 12] Total Simulation Time: 1651.19ms
[NCCL Rank 5] Total Simulation Time: 1648.04ms
[NCCL Rank 6] Total Simulation Time: 1648.05ms
[NCCL Rank 9] Total Simulation Time: 1648.73ms
[NCCL Rank 10] Total Simulation Time: 1649.31ms
[NCCL Rank 3] Total Simulation Time: 1650.78ms
[MPI Rank 0]: Shuffle 0 cost 247.29ms on average.
[MPI Rank 0]: Shuffle 1 cost 240.56ms on average.
[MPI Rank 0]: Shuffle 2 cost 233.52ms on average.
[MPI Rank 0]: Shuffle 3 cost 236.14ms on average.
[NCCL Rank 13] Total Simulation Time: 1654.22ms
[NCCL Rank 14] Total Simulation Time: 1654.23ms
[NCCL Rank 7] Total Simulation Time: 1650.85ms
[NCCL Rank 11] Total Simulation Time: 1651.98ms
[NCCL Rank 15] Total Simulation Time: 1657.04ms
[MPI Rank 0]: Destroyed everything!
Time Cost: 1767836 us
Destroyed the simulator
[MPI Rank 3]: Destroyed everything!
Time Cost: 1774633 us
Destroyed the simulator
[MPI Rank 1]: Destroyed everything!
Time Cost: 1822747 us
Destroyed the simulator
[MPI Rank 2]: Destroyed everything!
Time Cost: 1835046 us
Destroyed the simulator
